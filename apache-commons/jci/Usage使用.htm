<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at 14 October 2013 ( $Revision: 1080083 $ ) -->
<!-- $HeadURL: https://svn.apache.org/repos/asf/commons/proper/commons-skin/trunk/src/main/resources/META-INF/maven/site.vm $ -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <title>Apache Commons JCI - 
        Apache Commons JCI - Usage</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="Usage%E4%BD%BF%E7%94%A8_files/print.htm" type="text/css" media="print">
      <meta name="author" content="Commons Development Team">
    <meta name="Date-Revision-yyyymmdd" content="20131014">
    <meta http-equiv="Content-Language" content="en">
                                                    
<link rel="stylesheet" type="text/css" media="all" href="Usage%E4%BD%BF%E7%94%A8_files/prettify.css">                                                        
<script src="Usage%E4%BD%BF%E7%94%A8_files/prettify.js" type="text/javascript"></script>                                                        
<script type="text/javascript">window.onload=function() {
              prettyPrint();
          }</script>                      
        </head>
  <body class="composite">
    <div id="banner">
            <div id="bannerLeft">
                                            <a href="http://commons.apache.org/" title="Apache Commons logo">
                                        <img src="Usage%E4%BD%BF%E7%94%A8_files/commons-logo.png" alt="Apache Commons logo">
                </a>
            </div><!-- id="bannerLeft" -->
              <div id="bannerRight">
                                                          <a href="http://commons.apache.org/jci/">
                                                <img src="Usage%E4%BD%BF%E7%94%A8_files/jci-logo-white.png" alt="Apache Commons JCI">
                </a>
            </div><!-- id="bannerRight" -->
        <div class="clear">
        <hr>
      </div>
    </div>
    <div id="breadcrumbs">
            
                
                <div class="xleft">
        <span id="publishDate">Last Published: 14 October 2013</span>
                  &nbsp;| <span id="projectVersion">Version: 1.1</span>
                      </div>
            <div class="xright">                    <a href="http://www.apachecon.com/" class="externalLink" title="ApacheCon">ApacheCon</a>
            |
                        <a href="http://www.apache.org/" class="externalLink" title="Apache">Apache</a>
            |
                        <a href="http://commons.apache.org/" title="Commons">Commons</a>
              
                
      </div>
      <div class="clear">
        <hr>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                
                                <h5>Apache Commons JCI</h5>
                  <ul>
                  <li class="none">
                          <a href="http://commons.apache.org/proper/commons-jci/index.html" title="About">About</a>
            </li>
                  <li class="none">
            <strong>Usage</strong>
          </li>
                  <li class="none">
                          <a href="http://commons.apache.org/proper/commons-jci/faq.html" title="FAQ">FAQ</a>
            </li>
                  <li class="none">
                          <a href="http://commons.apache.org/proper/commons-jci/issue-tracking.html" title="Issue Tracking">Issue Tracking</a>
            </li>
                  <li class="none">
                          <a href="http://commons.apache.org/proper/commons-jci/download_jci.cgi" title="Downloads">Downloads</a>
            </li>
                  <li class="none">
                          <a href="http://commons.apache.org/proper/commons-jci/apidocs/index.html" title="Javadoc">Javadoc</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                        
                                                                        
                                                                        
                                                  <li class="collapsed">
                          <a href="http://commons.apache.org/proper/commons-jci/project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                        
                                                                        
                                                                        
                                <li class="collapsed">
                          <a href="http://commons.apache.org/proper/commons-jci/project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                       <h5>Commons</h5>
                  <ul>
                  <li class="none">
                          <a href="http://commons.apache.org/" title="Home">Home</a>
            </li>
                  <li class="none">
                          <a href="http://www.apache.org/licenses/" class="externalLink" title="License">License</a>
            </li>
                                                                    <li class="collapsed">
                          <a href="http://commons.apache.org/components.html" title="Components">Components</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="http://commons.apache.org/sandbox/index.html" title="Sandbox">Sandbox</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="http://commons.apache.org/dormant/index.html" title="Dormant">Dormant</a>
                  </li>
          </ul>
                       <h5>General Information</h5>
                  <ul>
                  <li class="none">
                          <a href="http://commons.apache.org/volunteering.html" title="Volunteering">Volunteering</a>
            </li>
                  <li class="none">
                          <a href="http://commons.apache.org/patches.html" title="Contributing Patches">Contributing Patches</a>
            </li>
                  <li class="none">
                          <a href="http://commons.apache.org/building.html" title="Building Components">Building Components</a>
            </li>
                  <li class="none">
                          <a href="http://commons.apache.org/releases/index.html" title="Releasing Components">Releasing Components</a>
            </li>
                  <li class="none">
                          <a href="http://wiki.apache.org/commons/FrontPage" class="externalLink" title="Wiki">Wiki</a>
            </li>
          </ul>
                       <h5>ASF</h5>
                  <ul>
                  <li class="none">
                          <a href="http://www.apache.org/foundation/how-it-works.html" class="externalLink" title="How the ASF works">How the ASF works</a>
            </li>
                  <li class="none">
                          <a href="http://www.apache.org/foundation/getinvolved.html" class="externalLink" title="Get Involved">Get Involved</a>
            </li>
                  <li class="none">
                          <a href="http://www.apache.org/dev/" class="externalLink" title="Developer Resources">Developer Resources</a>
            </li>
                  <li class="none">
                          <a href="http://www.apache.org/foundation/sponsorship.html" class="externalLink" title="Sponsorship">Sponsorship</a>
            </li>
                  <li class="none">
                          <a href="http://www.apache.org/foundation/thanks.html" class="externalLink" title="Thanks">Thanks</a>
            </li>
          </ul>
                                                                                                                   <a href="http://www.apache.org/events/current-event.html" title="ApacheCon" class="poweredBy">
        <img class="poweredBy" alt="ApacheCon" src="Usage%E4%BD%BF%E7%94%A8_files/current-event-125x125.png">
      </a>
                                                                                                    <a href="http://maven.apache.org/" title="Maven" class="poweredBy">
        <img class="poweredBy" alt="Maven" src="Usage%E4%BD%BF%E7%94%A8_files/maven-feather.png">
      </a>
                       
                
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!-- Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
   this work for additional information regarding copyright ownership.
   The ASF licenses this file to You under the Apache License, Version 2.0
   (the "License"); you may not use this file except in compliance with
   the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License. -->
    
        <div class="section">
<h2>Compilation<a name="Compilation"></a></h2>
            
<p>
                The <tt>JavaCompiler</tt> is quite simple. You have to provide the paths to
                the sources, where to get the sources from and where to store the classes. Then
                you just pick one of the compilers to do the work. The result of the compilation
                is returned as a <tt>CompilationResult</tt>.
            </p>
            

<div class="source"><span class="pln"><br></span><pre><span class="typ">JavaCompiler</span><span class="pln"> compiler </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">JavaCompilerFactory</span><span class="pun">().</span><span class="pln">createCompiler</span><span class="pun">(</span><span class="str">"eclipse"</span><span class="pun">);</span><span class="pln"><br></span><span class="typ">CompilationResult</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> compiler</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">sources</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileResourceReader</span><span class="pun">(</span><span class="pln">sourceDir</span><span class="pun">),</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileResourceStore</span><span class="pun">(</span><span class="pln">targetDir</span><span class="pun">));</span><span class="pln"><br><br></span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln"> result</span><span class="pun">.</span><span class="pln">getErrors</span><span class="pun">().</span><span class="pln">length </span><span class="pun">+</span><span class="pln"> </span><span class="str">" errors"</span><span class="pun">);</span><span class="pln"><br></span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln"> result</span><span class="pun">.</span><span class="pln">getWarnings</span><span class="pun">().</span><span class="pln">length </span><span class="pun">+</span><span class="pln"> </span><span class="str">" warnings"</span><span class="pun">);</span><span class="pln"><br></span></pre></div>
            
<p>
                Information like line numbers of errors etc are accessible in a consistent way.
                If supported by the compiler you can even get notified about error before the
                end of the compilation. (see the <tt>CompilationProblemHandler</tt>) for that.
                The example module provides a simple
                <a href="http://commons.apache.org/proper/commons-jci/xref/org/apache/commons/jci/examples/serverpages/ServerPageServlet.html">JSP servlet</a>
                and a javac-like <a href="http://commons.apache.org/proper/commons-jci/xref/org/apache/commons/jci/examples/commandline/CommandlineCompiler.html">command line interface</a>.
            </p>
            
        </div>

        
<div class="section">
<h2>Filesystem monitoring<a name="Filesystem_monitoring"></a></h2>
            
<p>
                A subproject of JCI provides a <tt>FilesystemAlterationMonitor</tt> that can
                be used to get notified when files change on the local filesystem. If you attach
                a <tt>ReloadingListener</tt> or a <tt>CompilingListener</tt> it can even
                trigger the reload of a class in the <tt>ReloadingClassLoader</tt>.
            </p>

<div class="source"><span class="pln"><br></span><pre><span class="typ">ReloadingClassLoader</span><span class="pln"> classloader </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ReloadingClassLoader</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">getClass</span><span class="pun">().</span><span class="pln">getClassLoader</span><span class="pun">());</span><span class="pln"><br></span><span class="typ">ReloadingListener</span><span class="pln"> listener </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ReloadingListener</span><span class="pun">();</span><span class="pln"><br><br>listener</span><span class="pun">.</span><span class="pln">addReloadNotificationListener</span><span class="pun">(</span><span class="pln">classloader</span><span class="pun">);</span><span class="pln"><br><br></span><span class="typ">FilesystemAlterationMonitor</span><span class="pln"> fam </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FilesystemAlterationMonitor</span><span class="pun">();</span><span class="pln"><br>fam</span><span class="pun">.</span><span class="pln">addListener</span><span class="pun">(</span><span class="pln">directory</span><span class="pun">,</span><span class="pln"> listener</span><span class="pun">);</span><span class="pln"><br>fam</span><span class="pun">.</span><span class="pln">start</span><span class="pun">();</span><span class="pln"><br></span></pre></div>
            
<p>
                But you can also just implement a simple <tt>FilesystemAlterationListener</tt>
                yourself and just use it to get notified about configuration files changes
                <a href="http://commons.apache.org/proper/commons-jci/xref/org/apache/commons/jci/examples/configuration/ConfigurationReloading.html">for example</a>.
                The example just extends the <tt>FileChangeListener</tt> that provides a few convenience methods.
            </p>

        </div>
      
        
<div class="section">
<h2>Maven artifacts<a name="Maven_artifacts"></a></h2>
          
<p>
            Commons JCI is split into several modules, there is one artifact per compiler. Using the Eclipse compiler
            requires to declare the following dependency in your project:
          </p>

<div class="source"><span class="pln"><br></span><pre><span class="pln"> &nbsp;</span><span class="pun">&lt;</span><span class="tag">dependency</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="tag">groupId</span><span class="pun">&gt;</span><span class="pln">org.apache.commons</span><span class="pun">&lt;/</span><span class="tag">groupId</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="tag">artifactId</span><span class="pun">&gt;</span><span class="pln">commons-jci-eclipse</span><span class="pun">&lt;/</span><span class="tag">artifactId</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">&lt;</span><span class="tag">version</span><span class="pun">&gt;</span><span class="pln">1.1</span><span class="pun">&lt;/</span><span class="tag">version</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; </span><span class="pun">&lt;/</span><span class="tag">dependency</span><span class="pun">&gt;</span><span class="pln"><br></span></pre></div>
          
<p>The other artifacts are <tt>commons-jci-groovy</tt>, <tt>commons-jci-janino</tt>
          and <tt>commons-jci-rhino</tt>.</p>  
        </div>
    

      </div>
    </div>
    <div class="clear">
      <hr>
    </div>
    <div id="footer">
      <div class="center">Copyright ©                    2004-2013
                        <a href="http://www.apache.org/">The Apache Software Foundation</a>.
            All Rights Reserved.      
                
      </div>
                          
<div class="center">Apache Commons, Apache Apache Commons JCI, Apache, 
the Apache feather logo, and the Apache Commons project logos are 
trademarks of The Apache Software Foundation.
      All other marks mentioned may be trademarks or registered 
trademarks of their respective owners.</div>
                <div class="clear">
        <hr>
      </div>
    </div>
  
</body></html>