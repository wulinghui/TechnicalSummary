<!DOCTYPE html>
<!-- saved from url=(0045)https://www.cnblogs.com/kanyun/p/7466309.html -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="referrer" content="origin">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <title>Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园</title>
    <meta property="og:description" content="一个示例： 已=开头表示精确匹配如 A 中只匹配根目录结尾的请求，后面不能带任何字符串。 ^~ 开头表示uri以某个常规字符串开头，不是正则匹配 ~ 开头表示区分大小写的正则匹配; ~* 开">
    <link type="text/css" rel="stylesheet" href="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/blog-common.css">
<link id="MainCss" type="text/css" rel="stylesheet" href="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/bundle-MoonlightInk.css">
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/bundle-MoonlightInk-mobile.css">
    <link title="RSS" type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/kanyun/rss">
    <link title="RSD" type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/kanyun/rsd.xml">
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/kanyun/wlwmanifest.xml">
    <script src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/amp4ads-host-v0.js.下载"></script><script src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/pubads_impl_rendering_2019061301.js.下载"></script><script async="" src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/analytics.js.下载"></script><script type="text/javascript" src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/encoder.js.下载"></script><script src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/jquery-2.2.0.min.js.下载"></script>
    <script>var currentBlogId=361656;var currentBlogApp='kanyun',cb_enable_mathjax=false;var isLogined=false;</script>
    <script src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/blog-common.js.下载" type="text/javascript"></script>
<link rel="preload" href="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/f.txt" as="script"><script type="text/javascript" src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/f.txt"></script><script src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/pubads_impl_2019061301.js.下载" async=""></script><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-33/html/container.html"></head>
<body>
<a name="top"></a>


<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a id="lnkBlogLogo" href="https://www.cnblogs.com/kanyun/"><img id="blogLogo" src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/logo.gif" alt="返回主页"></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="https://www.cnblogs.com/kanyun/">陈无问</a></h1>
<h2></h2>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">博客园</a></li>
<li><a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/kanyun/">首页</a></li>
<li><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
<li><a id="blog_nav_contact" class="menu" rel="nofollow" href="https://msg.cnblogs.com/send/%E9%99%88%E6%97%A0%E9%97%AE">联系</a></li>
<li><a id="blog_nav_rss" class="menu" href="https://www.cnblogs.com/kanyun/rss">订阅</a>
<!--<a id="blog_nav_rss_image" class="aHeaderXML" href="https://www.cnblogs.com/kanyun/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a>--></li>
<li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
</ul>
		<div class="blogStats">
			
			<div id="blog_stats">
<span id="stats_post_count">随笔 - 25&nbsp; </span>
<span id="stats_article_count">文章 - 0&nbsp; </span>
<span id="stats-comment_count">评论 - 4</span>
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
        <div id="post_detail">
<!--done-->
<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/kanyun/p/7466309.html">Nginx配置请求转发location及rewrite规则</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body"><p>一个示例：</p>
<p>&nbsp;</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #000000;">location  = / {
  # 精确匹配 / ，主机名后面不能带任何字符串
  [ configuration A ] 
}

location  / {
  # 因为所有的地址都以 / 开头，所以这条规则将匹配到所有请求
  # 但是正则和最长字符串会优先匹配
  [ configuration B ] 
}

location /documents/ {
  # 匹配任何以 /documents/ 开头的地址，匹配符合以后，还要继续往下搜索
  # 只有后面的正则表达式没有匹配到时，这一条才会采用这一条
  [ configuration C ] 
}

location ~ /documents/Abc {
  # 匹配任何以 /documents/ 开头的地址，匹配符合以后，还要继续往下搜索
  # 只有后面的正则表达式没有匹配到时，这一条才会采用这一条
  [ configuration CC ] 
}

location ^~ /images/ {
  # 匹配任何以 /images/ 开头的地址，匹配符合以后，停止往下搜索正则，采用这一条。
  [ configuration D ] 
}

location ~* \.(gif|jpg|jpeg)$ {
  # 匹配所有以 gif,jpg或jpeg 结尾的请求
  # 然而，所有请求 /images/ 下的图片会被 config D 处理，因为 ^~ 到达不了这一条正则
  [ configuration E ] 
}

location /images/ {
  # 字符匹配到 /images/，继续往下，会发现 ^~ 存在
  [ configuration F ] 
}

location /images/abc {
  # 最长字符匹配到 /images/abc，继续往下，会发现 ^~ 存在
  # F与G的放置顺序是没有关系的
  [ configuration G ] 
}

location ~ /images/abc/ {
  # 只有去掉 config D 才有效：先最长匹配 config G 开头的地址，继续往下搜索，匹配到这一条正则，采用
    [ configuration H ] 
}

location ~* /js/.*/\.js</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<ul>
<li>已<code>=</code>开头表示精确匹配<br>如 A 中只匹配根目录结尾的请求，后面不能带任何字符串。</li>
<li><code>^~</code>&nbsp;开头表示uri以某个常规字符串开头，不是正则匹配</li>
<li>~ 开头表示区分大小写的正则匹配;</li>
<li>~* 开头表示不区分大小写的正则匹配</li>
<li>/ 通用匹配, 如果没有其它匹配,任何请求都会匹配到</li>

</ul>
<p>顺序 no优先级：<br>(location =) &gt; (location 完整路径) &gt; (location ^~ 路径) &gt; (location ~,~* 正则顺序) &gt; (location 部分起始路径) &gt; (/)</p>
<p>上面的匹配结果<br>按照上面的location写法，以下的匹配示例成立：</p>
<ul>
<li>/ -&gt; config A<br>精确完全匹配，即使/index.html也匹配不了</li>
<li>/downloads/download.html -&gt; config B<br>匹配B以后，往下没有任何匹配，采用B</li>
<li>/images/1.gif -&gt; configuration D<br>匹配到F，往下匹配到D，停止往下</li>
<li>/images/abc/def -&gt; config D<br>最长匹配到G，往下匹配D，停止往下<br>你可以看到 任何以/images/开头的都会匹配到D并停止，FG写在这里是没有任何意义的，H是永远轮不到的，这里只是为了说明匹配顺序</li>
<li>/documents/document.html -&gt; config C<br>匹配到C，往下没有任何匹配，采用C</li>
<li>/documents/1.jpg -&gt; configuration E<br>匹配到C，往下正则匹配到E</li>
<li>/documents/Abc.jpg -&gt; config CC<br>最长匹配到C，往下正则顺序匹配到CC，不会往下到E</li>

</ul>
<h3 id="articleHeader1">实际使用建议</h3>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #000000;">所以实际使用中，个人觉得至少有三个匹配规则定义，如下：
#直接匹配网站根，通过域名访问网站首页比较频繁，使用这个会加速处理，官网如是说。
#这里是直接转发给后端应用服务器了，也可以是一个静态首页
# 第一个必选规则
location = / {
    proxy_pass http://tomcat:8080/index
}
# 第二个必选规则是处理静态文件请求，这是nginx作为http服务器的强项
# 有两种配置模式，目录匹配或后缀匹配,任选其一或搭配使用
location ^~ /static/ {
    root /webroot/static/;
}
location ~* \.(gif|jpg|jpeg|png|css|js|ico)$ {
    root /webroot/res/;
}
#第三个规则就是通用规则，用来转发动态请求到后端应用服务器
#非静态文件请求就默认是动态请求，自己根据实际把握
#毕竟目前的一些框架的流行，带.php,.jsp后缀的情况很少了
location / {
    proxy_pass http://tomcat:8080/
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<h1 id="articleHeader2">Rewrite规则</h1>
<p>rewrite功能就是，使用nginx提供的全局变量或自己设置的变量，结合正则表达式和标志位实现url重写以及重定向。rewrite只能放在server{},location{},if{}中，并且只能对域名后边的除去传递的参数外的字符串起作用，例如&nbsp;<code>http://seanlook.com/a/we/index.php?id=1&amp;u=str</code>&nbsp;只对/a/we/index.php重写。语法<code>rewrite regex replacement [flag];</code></p>
<p>如果相对域名或参数字符串起作用，可以使用全局变量匹配，也可以使用proxy_pass反向代理。</p>
<p>表明看rewrite和location功能有点像，都能实现跳转，主要区别在于rewrite是在同一域名内更改获取资源的路径，而location是对一类路径做控制访问或反向代理，可以proxy_pass到其他机器。很多情况下rewrite也会写在location里，它们的执行顺序是：</p>
<ol>
<li>执行server块的rewrite指令</li>
<li>执行location匹配</li>
<li>执行选定的location中的rewrite指令</li>
</ol>
<p>如果其中某步URI被重写，则重新循环执行1-3，直到找到真实存在的文件；循环超过10次，则返回500 Internal Server Error错误。</p>
<h2 id="articleHeader3">flag标志位</h2>
<ul>
<li><code>last</code>&nbsp;: 相当于Apache的[L]标记，表示完成rewrite</li>
<li><code>break</code>&nbsp;: 停止执行当前虚拟主机的后续rewrite指令集</li>
<li><code>redirect</code>&nbsp;: 返回302临时重定向，地址栏会显示跳转后的地址</li>
<li><code>permanent</code>&nbsp;: 返回301永久重定向，地址栏会显示跳转后的地址</li>
</ul>
<p>因为301和302不能简单的只返回状态码，还必须有重定向的URL，这就是return指令无法返回301,302的原因了。这里 last 和 break 区别有点难以理解：</p>
<ol>
<li>last一般写在server和if中，而break一般使用在location中</li>
<li>last不终止<em>重写后</em>的url匹配，即新的url会再从server走一遍匹配流程，而break终止重写后的匹配</li>
<li>break和last都能组织继续执行后面的rewrite指令</li>
</ol>
<h2 id="articleHeader4">if指令与全局变量</h2>
<p><strong>if判断指令</strong><br>语法为<code>if(condition){...}</code>，对给定的条件condition进行判断。如果为真，大括号内的rewrite指令将被执行，if条件(conditon)可以是如下任何内容：</p>
<ul>
<li>当表达式只是一个变量时，如果值为空或任何以0开头的字符串都会当做false</li>
<li>直接比较变量和内容时，使用<code>=</code>或<code>!=</code></li>
<li><code>~</code>正则表达式匹配，<code>~*</code>不区分大小写的匹配，<code>!~</code>区分大小写的不匹配</li>

</ul>
<p><code>-f</code>和<code>!-f</code>用来判断是否存在文件<br><code>-d</code>和<code>!-d</code>用来判断是否存在目录<br><code>-e</code>和<code>!-e</code>用来判断是否存在文件或目录<br><code>-x</code>和<code>!-x</code>用来判断文件是否可执行</p>
<p>例如：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #000000;">if ($http_user_agent ~ MSIE) {
    rewrite ^(.*)$ /msie/$1 break;
} //如果UA包含"MSIE"，rewrite请求到/msid/目录下

if ($http_cookie ~* "id=([^;]+)(?:;|$)") {
    set $id $1;
 } //如果cookie匹配正则，设置变量$id等于正则引用部分

if ($request_method = POST) {
    return 405;
} //如果提交方法为POST，则返回状态405（Method not allowed）。return不能返回301,302

if ($slow) {
    limit_rate 10k;
} //限速，$slow可以通过 set 指令设置

if (!-f $request_filename){
    break;
    proxy_pass  http://127.0.0.1; 
} //如果请求的文件名不存在，则反向代理到localhost 。这里的break也是停止rewrite检查

if ($args ~ post=140){
    rewrite ^ http://example.com/ permanent;
} //如果query string中包含"post=140"，永久重定向到example.com

location ~* \.(gif|jpg|png|swf|flv)$ {
    valid_referers none blocked www.jefflei.com www.leizhenfang.com;
    if ($invalid_referer) {
        return 404;
    } //防盗链
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p><strong>全局变量</strong><br>下面是可以用作if判断的全局变量</p>
<ul>
<li><code>$args</code>&nbsp;： #这个变量等于请求行中的参数，同<code>$query_string</code></li>
<li><code>$content_length</code>&nbsp;： 请求头中的Content-length字段。</li>
<li><code>$content_type</code>&nbsp;： 请求头中的Content-Type字段。</li>
<li><code>$document_root</code>&nbsp;： 当前请求在root指令中指定的值。</li>
<li><code>$host</code>&nbsp;： 请求主机头字段，否则为服务器名称。</li>
<li><code>$http_user_agent</code>&nbsp;： 客户端agent信息</li>
<li><code>$http_cookie</code>&nbsp;： 客户端cookie信息</li>
<li><code>$limit_rate</code>&nbsp;： 这个变量可以限制连接速率。</li>
<li><code>$request_method</code>&nbsp;： 客户端请求的动作，通常为GET或POST。</li>
<li><code>$remote_addr</code>&nbsp;： 客户端的IP地址。</li>
<li><code>$remote_port</code>&nbsp;： 客户端的端口。</li>
<li><code>$remote_user</code>&nbsp;： 已经经过Auth Basic Module验证的用户名。</li>
<li><code>$request_filename</code>&nbsp;： 当前请求的文件路径，由root或alias指令与URI请求生成。</li>
<li><code>$scheme</code>&nbsp;： HTTP方法（如http，https）。</li>
<li><code>$server_protocol</code>&nbsp;： 请求使用的协议，通常是HTTP/1.0或HTTP/1.1。</li>
<li><code>$server_addr</code>&nbsp;： 服务器地址，在完成一次系统调用后可以确定这个值。</li>
<li><code>$server_name</code>&nbsp;： 服务器名称。</li>
<li><code>$server_port</code>&nbsp;： 请求到达服务器的端口号。</li>
<li><code>$request_uri</code>&nbsp;： 包含请求参数的原始URI，不包含主机名，如：”/foo/bar.php?arg=baz”。</li>
<li><code>$uri</code>&nbsp;： 不带请求参数的当前URI，$uri不包含主机名，如”/foo/bar.html”。</li>
<li><code>$document_uri</code>&nbsp;： 与$uri相同。</li>

</ul>
<p>例：<code>http://localhost:88/test1/test2/test.php</code><br>$host：localhost<br>$server_port：88<br>$request_uri：<a href="http://localhost:88/test1/test2/test.php" rel="nofollow" target="_blank">http://localhost:88/test1/test2/test.php</a><br>$document_uri：/test1/test2/test.php<br>$document_root：/var/www/html<br>$request_filename：/var/www/html/test1/test2/test.php</p>
<h2 id="articleHeader5">常用正则</h2>
<ul>
<li><code>.</code>&nbsp;： 匹配除换行符以外的任意字符</li>
<li><code>?</code>&nbsp;： 重复0次或1次</li>
<li><code>+</code>&nbsp;： 重复1次或更多次</li>
<li><code>*</code>&nbsp;： 重复0次或更多次</li>
<li><code>\d</code>&nbsp;：匹配数字</li>
<li><code>^</code>&nbsp;： 匹配字符串的开始</li>
<li><code>$</code>&nbsp;： 匹配字符串的介绍</li>
<li><code>{n}</code>&nbsp;： 重复n次</li>
<li><code>{n,}</code>&nbsp;： 重复n次或更多次</li>
<li><code>[c]</code>&nbsp;： 匹配单个字符c</li>
<li><code>[a-z]</code>&nbsp;： 匹配a-z小写字母的任意一个</li>

</ul>
<p>小括号<code>()</code>之间匹配的内容，可以在后面通过<code>$1</code>来引用，<code>$2</code>表示的是前面第二个<code>()</code>里的内容。正则里面容易让人困惑的是<code>\</code>转义特殊字符。</p>
<h2 id="articleHeader6">rewrite实例</h2>
<p><em>例1</em>：</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #000000;">http {
    # 定义image日志格式
    log_format imagelog '[$time_local] ' $image_file ' ' $image_type ' ' $body_bytes_sent ' ' $status;
    # 开启重写日志
    rewrite_log on;

    server {
        root /home/www;

        location / {
                # 重写规则信息
                error_log logs/rewrite.log notice; 
                # 注意这里要用‘’单引号引起来，避免{}
                rewrite '^/images/([a-z]{2})/([a-z0-9]{5})/(.*)\.(png|jpg|gif)$' /data?file=$3.$4;
                # 注意不能在上面这条规则后面加上“last”参数，否则下面的set指令不会执行
                set $image_file $3;
                set $image_type $4;
        }

        location /data {
                # 指定针对图片的日志格式，来分析图片类型和大小
                access_log logs/images.log mian;
                root /data/images;
                # 应用前面定义的变量。判断首先文件在不在，不在再判断目录在不在，如果还不在就跳转到最后一个url里
                try_files /$arg_file /image404.html;
        }
        location = /image404.html {
                # 图片不存在返回特定的信息
                return 404 "image not found\n";
        }
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>对形如<code>/images/ef/uh7b3/test.png</code>的请求，重写到<code>/data?file=test.png</code>，于是匹配到<code>location /data</code>，先看<code>/data/images/test.png</code>文件存不存在，如果存在则正常响应，如果不存在则重写tryfiles到新的image404 location，直接返回404状态码。</p>
<p><em>例2</em>：</p>
<div class="cnblogs_code">
<pre>rewrite ^/images/(.*)_(\d+)x(\d+)\.(png|jpg|gif)$ /resizer/$1.$4?width=$2<span style="color: #ff0000;">&amp;height</span>=$3? last;</pre>
</div>
<p>对形如<code>/images/bla_500x400.jpg</code>的文件请求，重写到<code>/resizer/bla.jpg?width=500&amp;height=400</code>地址，并会继续尝试匹配location。</p></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info"><div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(7466309,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
            <a id="green_channel_follow" onclick="follow(&#39;d0cbaf35-8721-e611-9fc1-ac853d9f53cc&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/kanyun/" target="_blank"><img src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/sample_face.gif" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/kanyun/">陈无问</a><br>
            <a href="https://home.cnblogs.com/u/kanyun/followees">关注 - 3</a><br>
            <a href="https://home.cnblogs.com/u/kanyun/followers">粉丝 - 1</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow(&#39;d0cbaf35-8721-e611-9fc1-ac853d9f53cc&#39;);return false;">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(7466309,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">0</span>
    </div>
    <div class="buryit" onclick="votePost(7466309,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>
<script type="text/javascript">
    currentDiggType = 0;
</script></div>
<div class="clear"></div>
<div id="post_next_prev"><a href="https://www.cnblogs.com/kanyun/p/7388683.html" class="p_n_p_prefix">« </a> 上一篇：<a href="https://www.cnblogs.com/kanyun/p/7388683.html" title="发布于2017-08-18 11:27">Easyui datagrid自定义排序</a><br><a href="https://www.cnblogs.com/kanyun/p/7818529.html" class="p_n_p_prefix">» </a> 下一篇：<a href="https://www.cnblogs.com/kanyun/p/7818529.html" title="发布于2017-11-11 10:53">spring AspectJ的Execution表达式</a><br></div>
</div>


		</div>
		<div class="postDesc">posted @ <span id="post-date">2017-09-02 12:28</span> <a href="https://www.cnblogs.com/kanyun/">陈无问</a> 阅读(<span id="post_view_count">1281</span>) 评论(<span id="post_comment_count">0</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=7466309" rel="nofollow">编辑</a> <a href="https://www.cnblogs.com/kanyun/p/7466309.html#" onclick="AddToWz(7466309);return false;">收藏</a></div>
	</div>
	<script type="text/javascript">var allowComments=true,cb_blogId=361656,cb_entryId=7466309,cb_blogApp=currentBlogApp,cb_blogUserGuid='d0cbaf35-8721-e611-9fc1-ac853d9f53cc',cb_entryCreatedDate='2017/9/2 12:28:00';loadViewCount(cb_entryId);var cb_postType=1;var isMarkdown=false;</script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="https://www.cnblogs.com/kanyun/p/7466309.html#" onclick="return RefreshPage();">刷新页面</a><a href="https://www.cnblogs.com/kanyun/p/7466309.html#top">返回顶部</a></div>
<div id="comment_form_container"><div class="login_tips">注册用户登录后才能发表评论，请 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login(&#39;commentform&#39;);">登录</a> 或 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，<a href="http://www.cnblogs.com/">访问</a>网站首页。</div></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"><a href="http://www.ucancode.com/index.htm" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-工控&#39;)">【推荐】超50万C++/C#源码: 大型实时仿真组态图形源码</a><br><a href="https://www.grapecity.com.cn/developer/spreadjs?utm_source=cnblogs&amp;utm_medium=blogpage&amp;utm_term=bottom&amp;utm_content=SpreadJS&amp;utm_campaign=community" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-SpreadJS&#39;)">【前端】SpreadJS表格控件，可嵌入系统开发的在线Excel</a><br></div>
<div id="opt_under_post"></div>
<script async="async" src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/gpt.js.下载"></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>
  googletag.cmd.push(function() {
        googletag.defineSlot('/1090369/C1', [300, 250], 'div-gpt-ad-1546353474406-0').addService(googletag.pubads());
        googletag.defineSlot('/1090369/C2', [468, 60], 'div-gpt-ad-1539008685004-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
  });
</script>
<div id="cnblogs_c1" class="c_ad_block">
    <div id="div-gpt-ad-1546353474406-0" style="height:250px; width:300px;" data-google-query-id="CL6Z_puf9-ICFQuylgodXwkLXA"><div id="google_ads_iframe_/1090369/C1_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1090369/C1_0" title="3rd party ad content" name="google_ads_iframe_/1090369/C1_0" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border: 0px; vertical-align: bottom;" data-google-container-id="1" data-load-complete="true" src="./Nginx配置请求转发location及rewrite规则 - 陈无问 - 博客园_files/saved_resource.html"></iframe></div></div>
</div>
<div id="under_post_news"><div class="recomm-block"><b>相关博文：</b><br>·  <a href="https://www.cnblogs.com/ligao/p/6407491.html" target="_blank" onclick="clickRecomItmem(6407491)">nginx配置location总结及rewrite规则写法</a><br>·  <a href="https://www.cnblogs.com/lanye/p/6149204.html" target="_blank" onclick="clickRecomItmem(6149204)">nginx配置location总结及rewrite规则写法</a><br>·  <a href="https://www.cnblogs.com/52fhy/p/5055233.html" target="_blank" onclick="clickRecomItmem(5055233)">rewrite规则写法及nginx配置location总结</a><br>·  <a href="https://www.cnblogs.com/duyinqiang/p/5696310.html" target="_blank" onclick="clickRecomItmem(5696310)">nginx配置location总结及rewrite规则写法</a><br>·  <a href="https://www.cnblogs.com/diegodu/p/5711633.html" target="_blank" onclick="clickRecomItmem(5711633)">nginx配置location总结及rewrite规则写法</a><br></div></div>
<div id="cnblogs_c2" class="c_ad_block">
    <div id="div-gpt-ad-1539008685004-0" style="height:60px; width:468px;" data-google-query-id="CL-Z_puf9-ICFQuylgodXwkLXA"><div id="google_ads_iframe_/1090369/C2_0__container__" style="border: 0pt none; width: 468px; height: 60px;"></div></div>
</div>
<div id="under_post_kb"><div class="itnews c_ad_block"><b>最新新闻</b>：<br> ·  <a href="https://news.cnblogs.com/n/627126/" target="_blank">人类无意中改变了狗脸部的肌肉</a><br> ·  <a href="https://news.cnblogs.com/n/627125/" target="_blank">广州发首批自动驾驶路测牌照 AutoX、广汽、文远知行等获准</a><br> ·  <a href="https://news.cnblogs.com/n/627124/" target="_blank">万字好文 | 重回恐龙灭绝的那一天</a><br> ·  <a href="https://news.cnblogs.com/n/627123/" target="_blank">孙宇晨：凭啥Facebook发币是区块链革命 我就是骗子?</a><br> ·  <a href="https://news.cnblogs.com/n/627122/" target="_blank">Ubuntu 19.10 将停止支持 x86_32 架构</a><br>» <a href="http://news.cnblogs.com/" title="IT新闻" target="_blank">更多新闻...</a></div></div>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
 if(enablePostBottom()) {
    codeHighlight();
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverT2();
    deliverC1();
    deliverC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);  
}
</script>
</div>

    
	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"><div id="profile_block">昵称：<a href="https://home.cnblogs.com/u/kanyun/">陈无问</a><br>园龄：<a href="https://home.cnblogs.com/u/kanyun/" title="入园时间：2016-05-24">3年</a><br>粉丝：<a href="https://home.cnblogs.com/u/kanyun/followers/">1</a><br>关注：<a href="https://home.cnblogs.com/u/kanyun/followees/">3</a><div id="p_b_follow"><a href="javascript:void(0);" onclick="follow(&#39;d0cbaf35-8721-e611-9fc1-ac853d9f53cc&#39;)">+加关注</a></div><script>getFollowStatus('d0cbaf35-8721-e611-9fc1-ac853d9f53cc')</script></div></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="blog-calendar" style=""><table id="blogCalendar" class="Cal" cellspacing="0" cellpadding="0" title="Calendar">
	<tbody><tr><td colspan="7"><table class="CalTitle" cellspacing="0">
		<tbody><tr><td class="CalNextPrev"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2019/05/01&#39;);return false;">&lt;</a></td><td align="center">2019年6月</td><td class="CalNextPrev" align="right"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2019/07/01&#39;);return false;">&gt;</a></td></tr>
	</tbody></table></td></tr><tr><th class="CalDayHeader" align="center" abbr="日" scope="col">日</th><th class="CalDayHeader" align="center" abbr="一" scope="col">一</th><th class="CalDayHeader" align="center" abbr="二" scope="col">二</th><th class="CalDayHeader" align="center" abbr="三" scope="col">三</th><th class="CalDayHeader" align="center" abbr="四" scope="col">四</th><th class="CalDayHeader" align="center" abbr="五" scope="col">五</th><th class="CalDayHeader" align="center" abbr="六" scope="col">六</th></tr><tr><td class="CalOtherMonthDay" align="center">26</td><td class="CalOtherMonthDay" align="center">27</td><td class="CalOtherMonthDay" align="center">28</td><td class="CalOtherMonthDay" align="center">29</td><td class="CalOtherMonthDay" align="center">30</td><td class="CalOtherMonthDay" align="center">31</td><td class="CalWeekendDay" align="center">1</td></tr><tr><td class="CalWeekendDay" align="center">2</td><td align="center">3</td><td align="center"><a href="https://www.cnblogs.com/kanyun/archive/2019/06/04.html"><u>4</u></a></td><td align="center">5</td><td align="center">6</td><td align="center">7</td><td class="CalWeekendDay" align="center">8</td></tr><tr><td class="CalWeekendDay" align="center">9</td><td align="center">10</td><td align="center">11</td><td align="center">12</td><td align="center">13</td><td align="center">14</td><td class="CalWeekendDay" align="center">15</td></tr><tr><td class="CalWeekendDay" align="center">16</td><td align="center">17</td><td align="center">18</td><td align="center">19</td><td class="CalTodayDay" align="center">20</td><td align="center">21</td><td class="CalWeekendDay" align="center">22</td></tr><tr><td class="CalWeekendDay" align="center">23</td><td align="center">24</td><td align="center">25</td><td align="center">26</td><td align="center">27</td><td align="center">28</td><td class="CalWeekendDay" align="center">29</td></tr><tr><td class="CalWeekendDay" align="center">30</td><td class="CalOtherMonthDay" align="center">1</td><td class="CalOtherMonthDay" align="center">2</td><td class="CalOtherMonthDay" align="center">3</td><td class="CalOtherMonthDay" align="center">4</td><td class="CalOtherMonthDay" align="center">5</td><td class="CalOtherMonthDay" align="center">6</td></tr>
</tbody></table></div><script type="text/javascript">loadBlogDefaultCalendar();</script>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"><div id="sidebar_search" class="sidebar-block">
<div id="sidebar_search" class="mySearch">
<h3 class="catListTitle">搜索</h3>
<div id="sidebar_search_box">
<div id="widget_my_zzk" class="div_my_zzk"><input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk"></div>
<div id="widget_my_google" class="div_my_zzk"><input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event)" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk"></div>
</div>
</div>

</div><div id="sidebar_shortcut" class="sidebar-block">
<div class="catListLink">
<h3 class="catListTitle">常用链接</h3>
<ul>
<li><a href="https://www.cnblogs.com/kanyun/p/" title="我的博客的随笔列表">我的随笔</a></li><li><a href="https://www.cnblogs.com/kanyun/MyComments.html" title="我发表过的评论列表">我的评论</a></li><li><a href="https://www.cnblogs.com/kanyun/OtherPosts.html" title="我评论过的随笔列表">我的参与</a></li><li><a href="https://www.cnblogs.com/kanyun/RecentComments.html" title="我的博客的评论列表">最新评论</a></li><li><a href="https://www.cnblogs.com/kanyun/tag/" title="我的博客的标签列表">我的标签</a></li>
</ul>
<div id="itemListLin_con" style="display:none;">
<ul>

</ul>
</div>
</div></div><div id="sidebar_toptags" class="sidebar-block">
<div class="catListTag">
<h3 class="catListTitle">我的标签</h3>
<ul>
<li><a href="https://www.cnblogs.com/kanyun/tag/Java/">Java</a>(2)</li><li><a href="https://www.cnblogs.com/kanyun/tag/Easyui/">Easyui</a>(2)</li><li><a href="https://www.cnblogs.com/kanyun/tag/html5/">html5</a>(1)</li><li><a href="https://www.cnblogs.com/kanyun/tag/ajax/">ajax</a>(1)</li><li><a href="https://www.cnblogs.com/kanyun/tag/javasrcipt/">javasrcipt</a>(1)</li><li><a href="https://www.cnblogs.com/kanyun/tag/Tree/">Tree</a>(1)</li><li><a href="https://www.cnblogs.com/kanyun/tag/%E9%80%92%E5%BD%92/">递归</a>(1)</li><li><a href="https://www.cnblogs.com/kanyun/tag/%E6%8E%92%E5%BA%8F/">排序</a>(1)</li>
</ul>
</div></div><div id="sidebar_categories">
<div id="sidebar_postarchive" class="catListPostArchive sidebar-block">
<h3 class="catListTitle">随笔档案</h3>

<ul>

<li><a id="CatList_LinkList_0_Link_0" href="https://www.cnblogs.com/kanyun/archive/2019/06.html">2019年6月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_1" href="https://www.cnblogs.com/kanyun/archive/2018/08.html">2018年8月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_2" href="https://www.cnblogs.com/kanyun/archive/2018/07.html">2018年7月 (3)</a> </li>

<li><a id="CatList_LinkList_0_Link_3" href="https://www.cnblogs.com/kanyun/archive/2018/03.html">2018年3月 (4)</a> </li>

<li><a id="CatList_LinkList_0_Link_4" href="https://www.cnblogs.com/kanyun/archive/2018/02.html">2018年2月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_5" href="https://www.cnblogs.com/kanyun/archive/2018/01.html">2018年1月 (3)</a> </li>

<li><a id="CatList_LinkList_0_Link_6" href="https://www.cnblogs.com/kanyun/archive/2017/12.html">2017年12月 (5)</a> </li>

<li><a id="CatList_LinkList_0_Link_7" href="https://www.cnblogs.com/kanyun/archive/2017/11.html">2017年11月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_8" href="https://www.cnblogs.com/kanyun/archive/2017/09.html">2017年9月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_9" href="https://www.cnblogs.com/kanyun/archive/2017/08.html">2017年8月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_10" href="https://www.cnblogs.com/kanyun/archive/2017/07.html">2017年7月 (1)</a> </li>

</ul>

</div>

</div><div id="sidebar_recentcomments" class="sidebar-block"><div id="recent_comments_wrap">
<div class="catListComment">
<h3 class="catListTitle">最新评论</h3>

	<div id="RecentCommentsBlock"><ul>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/kanyun/p/7388683.html#4220297">1. Re:Easyui datagrid自定义排序</a></li>
        <li class="recent_comment_body">我的easyUI初始化没有上下的箭头   是版本的原因吗</li>
        <li class="recent_comment_author">--TE丶Amo</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/kanyun/p/8079501.html#3976941">2. Re:使用IDEA开发Activiti工作流</a></li>
        <li class="recent_comment_body">感谢啊，正愁找不到连线呢</li>
        <li class="recent_comment_author">--苍狼小跟班</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/kanyun/p/8079501.html#3966893">3. Re:使用IDEA开发Activiti工作流</a></li>
        <li class="recent_comment_body">我觉得这样生成的流程图图片很难看，因为之前eclipse和spring tool suite生成的流程图图片很好看。在idea里有没有其他的生成方式？</li>
        <li class="recent_comment_author">--sunshine6</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/kanyun/p/7159232.html#3846855">4. Re:Java Web使用Html5 FormData实现多文件上传</a></li>
        <li class="recent_comment_body">可以使用<br>主要是使用js获取form的多个文件<br>使用RequestParam直接获取file的list，就不用request遍历了</li>
        <li class="recent_comment_author">--涩谷直子</li>
</ul>
</div>
</div>
</div></div><div id="sidebar_topviewedposts" class="sidebar-block"><div id="topview_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">阅读排行榜</h3>
	<div id="TopViewPostsBlock"><ul><li><a href="https://www.cnblogs.com/kanyun/p/8075414.html">1. Linux安装64位Mysql5.7(22281)</a></li><li><a href="https://www.cnblogs.com/kanyun/p/7827768.html">2. js遍历json的key和value(19174)</a></li><li><a href="https://www.cnblogs.com/kanyun/p/8079501.html">3. 使用IDEA开发Activiti工作流(16663)</a></li><li><a href="https://www.cnblogs.com/kanyun/p/7159232.html">4. Java Web使用Html5 FormData实现多文件上传(15797)</a></li><li><a href="https://www.cnblogs.com/kanyun/p/7388683.html">5. Easyui datagrid自定义排序(6233)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topcommentedposts" class="sidebar-block"><div id="topfeedback_posts_wrap">
<div class="catListFeedback">
<h3 class="catListTitle">评论排行榜</h3>
	<div id="TopFeedbackPostsBlock"><ul><li><a href="https://www.cnblogs.com/kanyun/p/8079501.html">1. 使用IDEA开发Activiti工作流(2)</a></li><li><a href="https://www.cnblogs.com/kanyun/p/7159232.html">2. Java Web使用Html5 FormData实现多文件上传(1)</a></li><li><a href="https://www.cnblogs.com/kanyun/p/7388683.html">3. Easyui datagrid自定义排序(1)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topdiggedposts" class="sidebar-block"><div id="topdigg_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">推荐排行榜</h3>
<div id="TopDiggPostsBlock"><ul><li><a href="https://www.cnblogs.com/kanyun/p/7159232.html">1. Java Web使用Html5 FormData实现多文件上传(2)</a></li><li><a href="https://www.cnblogs.com/kanyun/p/8079501.html">2. 使用IDEA开发Activiti工作流(2)</a></li><li><a href="https://www.cnblogs.com/kanyun/p/8571711.html">3. java离线地图web GIS制作(1)</a></li></ul></div>
</div></div></div></div><script type="text/javascript">loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright ©2019 陈无问
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->



</body></html>