<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>spring源码分析 | 资料总结</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="个人资料总结，存放笔记">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.76dfa4dd.css" as="style"><link rel="preload" href="/assets/js/app.7f63dd6c.js" as="script"><link rel="preload" href="/assets/js/2.fe5f2a1d.js" as="script"><link rel="preload" href="/assets/js/3.eb8c603e.js" as="script"><link rel="preload" href="/assets/js/152.bc7ad385.js" as="script"><link rel="prefetch" href="/assets/js/10.fe6b23fc.js"><link rel="prefetch" href="/assets/js/100.523c1b31.js"><link rel="prefetch" href="/assets/js/101.bbee1e6c.js"><link rel="prefetch" href="/assets/js/102.36d68ded.js"><link rel="prefetch" href="/assets/js/103.482d8685.js"><link rel="prefetch" href="/assets/js/104.9b20475d.js"><link rel="prefetch" href="/assets/js/105.0edc73b7.js"><link rel="prefetch" href="/assets/js/106.a9abfe31.js"><link rel="prefetch" href="/assets/js/107.2178a4c5.js"><link rel="prefetch" href="/assets/js/108.21d19ed0.js"><link rel="prefetch" href="/assets/js/109.5e1e3698.js"><link rel="prefetch" href="/assets/js/11.7d4a2ffb.js"><link rel="prefetch" href="/assets/js/110.ccc910aa.js"><link rel="prefetch" href="/assets/js/111.fcfd17d0.js"><link rel="prefetch" href="/assets/js/112.f91ccf6e.js"><link rel="prefetch" href="/assets/js/113.5cd28a7e.js"><link rel="prefetch" href="/assets/js/114.4ca8676c.js"><link rel="prefetch" href="/assets/js/115.c4d64d4e.js"><link rel="prefetch" href="/assets/js/116.47ba7426.js"><link rel="prefetch" href="/assets/js/117.3062ccb9.js"><link rel="prefetch" href="/assets/js/118.27991bba.js"><link rel="prefetch" href="/assets/js/119.53538539.js"><link rel="prefetch" href="/assets/js/12.ac798cdb.js"><link rel="prefetch" href="/assets/js/120.e9666755.js"><link rel="prefetch" href="/assets/js/121.73a1660e.js"><link rel="prefetch" href="/assets/js/122.59ac137e.js"><link rel="prefetch" href="/assets/js/123.b9124c91.js"><link rel="prefetch" href="/assets/js/124.12ffcf50.js"><link rel="prefetch" href="/assets/js/125.0403278b.js"><link rel="prefetch" href="/assets/js/126.cec37905.js"><link rel="prefetch" href="/assets/js/127.605a5010.js"><link rel="prefetch" href="/assets/js/128.a4cf61d9.js"><link rel="prefetch" href="/assets/js/129.164a08ce.js"><link rel="prefetch" href="/assets/js/13.8de4385c.js"><link rel="prefetch" href="/assets/js/130.1d4164bd.js"><link rel="prefetch" href="/assets/js/131.7796e583.js"><link rel="prefetch" href="/assets/js/132.c79c715f.js"><link rel="prefetch" href="/assets/js/133.48384f22.js"><link rel="prefetch" href="/assets/js/134.bf85bfff.js"><link rel="prefetch" href="/assets/js/135.1244d4cb.js"><link rel="prefetch" href="/assets/js/136.6650b052.js"><link rel="prefetch" href="/assets/js/137.e9f394e2.js"><link rel="prefetch" href="/assets/js/138.ae16527d.js"><link rel="prefetch" href="/assets/js/139.df1c969c.js"><link rel="prefetch" href="/assets/js/14.d82e6d84.js"><link rel="prefetch" href="/assets/js/140.a80aa424.js"><link rel="prefetch" href="/assets/js/141.10ab646d.js"><link rel="prefetch" href="/assets/js/142.508278ee.js"><link rel="prefetch" href="/assets/js/143.62aa16a7.js"><link rel="prefetch" href="/assets/js/144.c734b314.js"><link rel="prefetch" href="/assets/js/145.7dae44b0.js"><link rel="prefetch" href="/assets/js/146.b08fb7ab.js"><link rel="prefetch" href="/assets/js/147.6fee9f53.js"><link rel="prefetch" href="/assets/js/148.5a09fe8b.js"><link rel="prefetch" href="/assets/js/149.27046d2c.js"><link rel="prefetch" href="/assets/js/15.f0dc0e66.js"><link rel="prefetch" href="/assets/js/150.c05ae37c.js"><link rel="prefetch" href="/assets/js/151.57194eb1.js"><link rel="prefetch" href="/assets/js/153.b3c7d891.js"><link rel="prefetch" href="/assets/js/154.0d3a00e5.js"><link rel="prefetch" href="/assets/js/155.b9afdc01.js"><link rel="prefetch" href="/assets/js/156.bfc71798.js"><link rel="prefetch" href="/assets/js/157.43852835.js"><link rel="prefetch" href="/assets/js/158.785caaa2.js"><link rel="prefetch" href="/assets/js/159.1716fd78.js"><link rel="prefetch" href="/assets/js/16.1217969a.js"><link rel="prefetch" href="/assets/js/160.54dfc0be.js"><link rel="prefetch" href="/assets/js/161.3a486b71.js"><link rel="prefetch" href="/assets/js/162.4365dac4.js"><link rel="prefetch" href="/assets/js/163.9e0305ed.js"><link rel="prefetch" href="/assets/js/164.9af7099c.js"><link rel="prefetch" href="/assets/js/165.07230640.js"><link rel="prefetch" href="/assets/js/166.a13e993d.js"><link rel="prefetch" href="/assets/js/167.233c305e.js"><link rel="prefetch" href="/assets/js/168.86996235.js"><link rel="prefetch" href="/assets/js/169.c643487c.js"><link rel="prefetch" href="/assets/js/17.65771bc0.js"><link rel="prefetch" href="/assets/js/170.fed7e19e.js"><link rel="prefetch" href="/assets/js/171.a191947e.js"><link rel="prefetch" href="/assets/js/172.a2368c89.js"><link rel="prefetch" href="/assets/js/173.aad8acd6.js"><link rel="prefetch" href="/assets/js/174.e5c4e9f4.js"><link rel="prefetch" href="/assets/js/175.ef19ddcf.js"><link rel="prefetch" href="/assets/js/176.7b8490c3.js"><link rel="prefetch" href="/assets/js/177.7d1f01a3.js"><link rel="prefetch" href="/assets/js/178.c5ea1f87.js"><link rel="prefetch" href="/assets/js/179.e54bc218.js"><link rel="prefetch" href="/assets/js/18.69d253af.js"><link rel="prefetch" href="/assets/js/180.a0fc0bcd.js"><link rel="prefetch" href="/assets/js/181.8029f765.js"><link rel="prefetch" href="/assets/js/182.72075fe8.js"><link rel="prefetch" href="/assets/js/183.f74d77ba.js"><link rel="prefetch" href="/assets/js/184.3277cbcd.js"><link rel="prefetch" href="/assets/js/185.15940a23.js"><link rel="prefetch" href="/assets/js/186.810a303a.js"><link rel="prefetch" href="/assets/js/187.9c8777f6.js"><link rel="prefetch" href="/assets/js/188.fed55d48.js"><link rel="prefetch" href="/assets/js/189.7f09c5db.js"><link rel="prefetch" href="/assets/js/19.87ab5597.js"><link rel="prefetch" href="/assets/js/190.082d7cbc.js"><link rel="prefetch" href="/assets/js/191.9fb2ec38.js"><link rel="prefetch" href="/assets/js/192.167d2083.js"><link rel="prefetch" href="/assets/js/193.d1eeb947.js"><link rel="prefetch" href="/assets/js/194.09e61c12.js"><link rel="prefetch" href="/assets/js/195.969efb5f.js"><link rel="prefetch" href="/assets/js/196.3932e830.js"><link rel="prefetch" href="/assets/js/197.1dc355f6.js"><link rel="prefetch" href="/assets/js/198.1ad8dbbf.js"><link rel="prefetch" href="/assets/js/199.c6b23b90.js"><link rel="prefetch" href="/assets/js/20.3d741608.js"><link rel="prefetch" href="/assets/js/200.81a125db.js"><link rel="prefetch" href="/assets/js/201.5e2fd593.js"><link rel="prefetch" href="/assets/js/202.51a3fbc4.js"><link rel="prefetch" href="/assets/js/203.4ae7c4f4.js"><link rel="prefetch" href="/assets/js/204.5ba79932.js"><link rel="prefetch" href="/assets/js/205.05bb64e4.js"><link rel="prefetch" href="/assets/js/206.c1d5472b.js"><link rel="prefetch" href="/assets/js/207.ad43feb1.js"><link rel="prefetch" href="/assets/js/208.250144c5.js"><link rel="prefetch" href="/assets/js/209.41667b8a.js"><link rel="prefetch" href="/assets/js/21.23841fc1.js"><link rel="prefetch" href="/assets/js/210.b85ec988.js"><link rel="prefetch" href="/assets/js/211.8f2f9335.js"><link rel="prefetch" href="/assets/js/212.dea21e7c.js"><link rel="prefetch" href="/assets/js/213.9074d848.js"><link rel="prefetch" href="/assets/js/214.baaf02d5.js"><link rel="prefetch" href="/assets/js/215.e3149f2c.js"><link rel="prefetch" href="/assets/js/216.5ede3f02.js"><link rel="prefetch" href="/assets/js/217.06eb8901.js"><link rel="prefetch" href="/assets/js/218.ffe5fc66.js"><link rel="prefetch" href="/assets/js/219.69c6166f.js"><link rel="prefetch" href="/assets/js/22.b55e8e09.js"><link rel="prefetch" href="/assets/js/220.a83c1ecf.js"><link rel="prefetch" href="/assets/js/221.fb65c799.js"><link rel="prefetch" href="/assets/js/222.1ff261ff.js"><link rel="prefetch" href="/assets/js/223.807c2de7.js"><link rel="prefetch" href="/assets/js/224.33540594.js"><link rel="prefetch" href="/assets/js/225.21d88d75.js"><link rel="prefetch" href="/assets/js/226.00d419d7.js"><link rel="prefetch" href="/assets/js/227.19678a11.js"><link rel="prefetch" href="/assets/js/228.d09fe33c.js"><link rel="prefetch" href="/assets/js/229.c8dcc95e.js"><link rel="prefetch" href="/assets/js/23.d7449079.js"><link rel="prefetch" href="/assets/js/230.7477ad3f.js"><link rel="prefetch" href="/assets/js/231.f1013950.js"><link rel="prefetch" href="/assets/js/232.1e07d0e6.js"><link rel="prefetch" href="/assets/js/233.34e0f2b8.js"><link rel="prefetch" href="/assets/js/234.645446d8.js"><link rel="prefetch" href="/assets/js/235.3368fdbc.js"><link rel="prefetch" href="/assets/js/236.35ed0de0.js"><link rel="prefetch" href="/assets/js/237.4a189e89.js"><link rel="prefetch" href="/assets/js/238.d6580ef3.js"><link rel="prefetch" href="/assets/js/239.c518fd70.js"><link rel="prefetch" href="/assets/js/24.26f18aa6.js"><link rel="prefetch" href="/assets/js/240.14979636.js"><link rel="prefetch" href="/assets/js/241.95c3b00d.js"><link rel="prefetch" href="/assets/js/242.a214e307.js"><link rel="prefetch" href="/assets/js/243.273af8d4.js"><link rel="prefetch" href="/assets/js/244.e2d74303.js"><link rel="prefetch" href="/assets/js/245.fe562cb9.js"><link rel="prefetch" href="/assets/js/246.b40011af.js"><link rel="prefetch" href="/assets/js/247.dc1a9aae.js"><link rel="prefetch" href="/assets/js/248.d691ac20.js"><link rel="prefetch" href="/assets/js/249.191f742a.js"><link rel="prefetch" href="/assets/js/25.198594bf.js"><link rel="prefetch" href="/assets/js/250.205b92cf.js"><link rel="prefetch" href="/assets/js/251.acb8a80e.js"><link rel="prefetch" href="/assets/js/26.c817356c.js"><link rel="prefetch" href="/assets/js/27.6b812306.js"><link rel="prefetch" href="/assets/js/28.9048721b.js"><link rel="prefetch" href="/assets/js/29.bfda8510.js"><link rel="prefetch" href="/assets/js/30.eb1b6ab9.js"><link rel="prefetch" href="/assets/js/31.3f3dbd2f.js"><link rel="prefetch" href="/assets/js/32.006bc754.js"><link rel="prefetch" href="/assets/js/33.05d371fe.js"><link rel="prefetch" href="/assets/js/34.27cd6ff5.js"><link rel="prefetch" href="/assets/js/35.35409a6d.js"><link rel="prefetch" href="/assets/js/36.fd6a950b.js"><link rel="prefetch" href="/assets/js/37.c8fd6ef4.js"><link rel="prefetch" href="/assets/js/38.028a36a2.js"><link rel="prefetch" href="/assets/js/39.e4494792.js"><link rel="prefetch" href="/assets/js/4.ff2df22c.js"><link rel="prefetch" href="/assets/js/40.979dec53.js"><link rel="prefetch" href="/assets/js/41.ff9662db.js"><link rel="prefetch" href="/assets/js/42.5c1441fc.js"><link rel="prefetch" href="/assets/js/43.9657eae8.js"><link rel="prefetch" href="/assets/js/44.a6cb5e5c.js"><link rel="prefetch" href="/assets/js/45.c675440c.js"><link rel="prefetch" href="/assets/js/46.06205970.js"><link rel="prefetch" href="/assets/js/47.ded0c65e.js"><link rel="prefetch" href="/assets/js/48.296a6f26.js"><link rel="prefetch" href="/assets/js/49.1b2ec2ab.js"><link rel="prefetch" href="/assets/js/5.ecde23f9.js"><link rel="prefetch" href="/assets/js/50.e551e67f.js"><link rel="prefetch" href="/assets/js/51.122d5b68.js"><link rel="prefetch" href="/assets/js/52.c0444208.js"><link rel="prefetch" href="/assets/js/53.f47d6b86.js"><link rel="prefetch" href="/assets/js/54.e9c9b41b.js"><link rel="prefetch" href="/assets/js/55.77010c1f.js"><link rel="prefetch" href="/assets/js/56.387aacbb.js"><link rel="prefetch" href="/assets/js/57.ddcf78ad.js"><link rel="prefetch" href="/assets/js/58.908b88fc.js"><link rel="prefetch" href="/assets/js/59.8ff535f1.js"><link rel="prefetch" href="/assets/js/6.b928f1b9.js"><link rel="prefetch" href="/assets/js/60.c5018386.js"><link rel="prefetch" href="/assets/js/61.1514e08b.js"><link rel="prefetch" href="/assets/js/62.79bc9197.js"><link rel="prefetch" href="/assets/js/63.a6cb5e14.js"><link rel="prefetch" href="/assets/js/64.f149661c.js"><link rel="prefetch" href="/assets/js/65.30fa2026.js"><link rel="prefetch" href="/assets/js/66.e7f9f54e.js"><link rel="prefetch" href="/assets/js/67.7361f4a3.js"><link rel="prefetch" href="/assets/js/68.b67cc099.js"><link rel="prefetch" href="/assets/js/69.ba730416.js"><link rel="prefetch" href="/assets/js/7.b0514d37.js"><link rel="prefetch" href="/assets/js/70.45b9e858.js"><link rel="prefetch" href="/assets/js/71.2055eaae.js"><link rel="prefetch" href="/assets/js/72.75ec1304.js"><link rel="prefetch" href="/assets/js/73.3aa09b6b.js"><link rel="prefetch" href="/assets/js/74.fb3013f1.js"><link rel="prefetch" href="/assets/js/75.c837c896.js"><link rel="prefetch" href="/assets/js/76.9e6df886.js"><link rel="prefetch" href="/assets/js/77.4eb09ab0.js"><link rel="prefetch" href="/assets/js/78.06d19c8c.js"><link rel="prefetch" href="/assets/js/79.dfde586d.js"><link rel="prefetch" href="/assets/js/8.f86f2563.js"><link rel="prefetch" href="/assets/js/80.476da6d1.js"><link rel="prefetch" href="/assets/js/81.2b778375.js"><link rel="prefetch" href="/assets/js/82.abbf449f.js"><link rel="prefetch" href="/assets/js/83.24b0e8ea.js"><link rel="prefetch" href="/assets/js/84.f8694c96.js"><link rel="prefetch" href="/assets/js/85.f030e8b6.js"><link rel="prefetch" href="/assets/js/86.18853c72.js"><link rel="prefetch" href="/assets/js/87.4eca3df6.js"><link rel="prefetch" href="/assets/js/88.26b81c78.js"><link rel="prefetch" href="/assets/js/89.ae216049.js"><link rel="prefetch" href="/assets/js/9.7a3e1618.js"><link rel="prefetch" href="/assets/js/90.b0ee8ab4.js"><link rel="prefetch" href="/assets/js/91.a07b34f1.js"><link rel="prefetch" href="/assets/js/92.1c2952b1.js"><link rel="prefetch" href="/assets/js/93.e199901d.js"><link rel="prefetch" href="/assets/js/94.a901578c.js"><link rel="prefetch" href="/assets/js/95.641f6644.js"><link rel="prefetch" href="/assets/js/96.84a54aa3.js"><link rel="prefetch" href="/assets/js/97.c489ec61.js"><link rel="prefetch" href="/assets/js/98.5fb17174.js"><link rel="prefetch" href="/assets/js/99.c004152a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.76dfa4dd.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="资料总结" class="logo"> <span class="site-name can-hide">资料总结</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/goVersion181/" class="nav-link">go</a></div><div class="nav-item"><a href="/pages/springFramework/" aria-current="page" class="nav-link router-link-exact-active router-link-active">java</a></div><div class="nav-item"><a href="/pages/e5d517/" class="nav-link">云原生</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/pages/410b25/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/00291d/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/pages/846ee6/" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/pages/5465c3/" class="nav-link">MongoDB</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><!----> <span class="title" style="display:;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/853b5b/" class="nav-link">设计模式详解</a></li><li class="dropdown-item"><!----> <a href="/pages/ebc515/" class="nav-link">数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/pages/57778e/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/pages/282cd0/" class="nav-link">项目</a></li><li class="dropdown-item"><!----> <a href="/pages/2cd810/" class="nav-link">理论基础</a></li><li class="dropdown-item"><!----> <a href="/pages/6acd46/" class="nav-link">运营</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/wulinghui/TechnicalSummary" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src=""> <div class="blogger-info"><h3>linghui Wu</h3> <span>一只努力学飞的鱼</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/goVersion181/" class="nav-link">go</a></div><div class="nav-item"><a href="/pages/springFramework/" aria-current="page" class="nav-link router-link-exact-active router-link-active">java</a></div><div class="nav-item"><a href="/pages/e5d517/" class="nav-link">云原生</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/pages/410b25/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/00291d/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/pages/846ee6/" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/pages/5465c3/" class="nav-link">MongoDB</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><!----> <span class="title" style="display:;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/853b5b/" class="nav-link">设计模式详解</a></li><li class="dropdown-item"><!----> <a href="/pages/ebc515/" class="nav-link">数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/pages/57778e/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/pages/282cd0/" class="nav-link">项目</a></li><li class="dropdown-item"><!----> <a href="/pages/2cd810/" class="nav-link">理论基础</a></li><li class="dropdown-item"><!----> <a href="/pages/6acd46/" class="nav-link">运营</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/wulinghui/TechnicalSummary" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>java-se</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>jvm</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mybatis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Netty</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>爬虫 webmagic</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>spring</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/a2a4f1/" class="sidebar-link">spring官网项目介绍</a></li><li><a href="/pages/springFramework/" aria-current="page" class="active sidebar-link">spring源码分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#enableaspectjautoproxy" class="sidebar-link">@EnableAspectJAutoProxy</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#equals-hashcode-getclass方法会代理吗" class="sidebar-link">equals，hashCode，getClass方法会代理吗?</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#proxyfactory的运用" class="sidebar-link">ProxyFactory的运用</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#targetsource的使用" class="sidebar-link">TargetSource的使用</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#常见问题" class="sidebar-link">常见问题:</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level1"><a href="/pages/springFramework/#事务" class="sidebar-link">事务</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#核心类" class="sidebar-link">核心类</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#事务的高级用法" class="sidebar-link">事务的高级用法:</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level1"><a href="/pages/springFramework/#自己的疑惑" class="sidebar-link">自己的疑惑</a></li><li class="sidebar-sub-header level1"><a href="/pages/springFramework/#注解原理" class="sidebar-link">注解原理</a></li><li class="sidebar-sub-header level1"><a href="/pages/springFramework/#spring-设计模式" class="sidebar-link">Spring 设计模式</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#资源访问resource接口" class="sidebar-link">资源访问Resource接口</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level1"><a href="/pages/springFramework/#spring核心api" class="sidebar-link">Spring核心API</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#beanfactory" class="sidebar-link">BeanFactory</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#beandefinition" class="sidebar-link">BeanDefinition</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/springFramework/#实现类" class="sidebar-link">实现类</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#beandefinitionregistry" class="sidebar-link">BeanDefinitionRegistry</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/springFramework/#实现类-2" class="sidebar-link">实现类</a></li><li class="sidebar-sub-header level1"><a href="/pages/springFramework/#问题" class="sidebar-link">问题</a></li><li class="sidebar-sub-header level1"><a href="/pages/springFramework/#扩展点" class="sidebar-link">扩展点</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#beanfactorypostprocessor-2" class="sidebar-link">BeanFactoryPostProcessor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/springFramework/#beandefinitionregistrypostprocessor" class="sidebar-link">BeanDefinitionRegistryPostProcessor</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#beanpostprocessor-2" class="sidebar-link">BeanPostProcessor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/springFramework/#instantiationawarebeanpostprocessor" class="sidebar-link">InstantiationAwareBeanPostProcessor</a></li><li class="sidebar-sub-header level3"><a href="/pages/springFramework/#abstractautoproxycreator" class="sidebar-link">AbstractAutoProxyCreator</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#import" class="sidebar-link">@Import</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/springFramework/#importbeandefinitionregistrar" class="sidebar-link">ImportBeanDefinitionRegistrar</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#aware" class="sidebar-link">Aware</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#initializingbean" class="sidebar-link">InitializingBean</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#factorybean" class="sidebar-link">FactoryBean</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#smartinitializingsingleton" class="sidebar-link">SmartInitializingSingleton</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#applicationlistener" class="sidebar-link">ApplicationListener</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#lifecycle" class="sidebar-link">Lifecycle</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/springFramework/#smartlifecycle" class="sidebar-link">SmartLifecycle</a></li><li class="sidebar-sub-header level3"><a href="/pages/springFramework/#lifecycleprocessor" class="sidebar-link">LifecycleProcessor</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#handlerinterceptor" class="sidebar-link">HandlerInterceptor</a></li><li class="sidebar-sub-header level2"><a href="/pages/springFramework/#methodinterceptor" class="sidebar-link">MethodInterceptor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level1"><a href="/pages/springFramework/#参考资料-2" class="sidebar-link">参考资料</a></li></ul></li></ul></li><li><a href="/pages/915c4e/" class="sidebar-link">spring-mvc</a></li><li><a href="/pages/6e2c36/" class="sidebar-link">spring-boot配置笔记</a></li><li><a href="/pages/acd420/" class="sidebar-link">SpringBoot项目部署之外挂配置文件Deploy方式</a></li><li><a href="/pages/66277d/" class="sidebar-link">SpringBoot源码分析</a></li><li><a href="/pages/2e8911/" class="sidebar-link">SpringBoot源码分析之条件注解</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>spring-cloud</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>中间件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>flowable</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>idea工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>maven</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ms</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>java部署</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>原生安卓</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/categories/?category=java" title="分类" data-v-06970110>java</a></li><li data-v-06970110><a href="/categories/?category=spring" title="分类" data-v-06970110>spring</a></li></ul> <div class="info" data-v-06970110><div title="作者" class="author iconfont icon-touxiang" data-v-06970110><a href="https://gitee.com/hellowllh/projects" target="_blank" title="作者" class="beLink" data-v-06970110>wulinghui</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2021-12-10</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">spring源码分析<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h1> <p><a href="https://juejin.cn/user/4195392104701415/posts" target="_blank" rel="noopener noreferrer">spring源码系列<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="mergedbeandefinition"><a href="#mergedbeandefinition" class="header-anchor">#</a> MergedBeanDefinition</h1> <p><a href="https://blog.csdn.net/m0_37607945/article/details/107411096" target="_blank" rel="noopener noreferrer">什么是MergedBeanDefinition?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.cn/post/6844904167941603341" target="_blank" rel="noopener noreferrer">Spring源码分析七、MergeBeanDefinition源码分析<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>有父beanName,且名字相同的话,可能是在父容器里面。</p></blockquote> <p><a href="https://zhuanlan.zhihu.com/p/28134832" target="_blank" rel="noopener noreferrer">关于Spring父子容器配置了相同id的Bean<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>结论：</p> <ul><li>同一个容器，相同的id的Bean会被覆盖（也可以修改默认配置，改为抛异常）。</li> <li><a href="https://www.zhihu.com/search?q=%E7%88%B6%E5%AD%90%E5%AE%B9%E5%99%A8&amp;search_source=Entity&amp;hybrid_search_source=Entity&amp;hybrid_search_extra=%7B%22sourceType%22%3A%22article%22%2C%22sourceId%22%3A28134832%7D" target="_blank" rel="noopener noreferrer">父子容器<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，相同的id的Bean不会被覆盖，但是由于id相同，也可能会导致注入时的出错。</li></ul></blockquote> <h1 id="beanfactorypostprocessor"><a href="#beanfactorypostprocessor" class="header-anchor">#</a> BeanFactoryPostProcessor</h1> <p>ConfigurationClassPostProcessor</p> <blockquote><p>他还实现了BeanDefinitionRegistryPostProcessor，用于注册beanDefinition，也就是解析配置类和包扫描</p></blockquote> <ol><li><p>postProcessBeanDefinitionRegistry 回调中的 processConfigBeanDefinitions 核心方法:</p> <ul><li><p>获得所有的BeanDefinitionName，循环遍历那些是判断配置类，并且给他们排序，设置环境变量、生成name、parser、</p></li> <li><p>如何判断配置类:</p> <blockquote><p>有full配置类： @Configuration</p> <p>lite配置类:   只要存在@Component、@ComponentScan、@Import、@ImportResource、有@Bean方法。</p></blockquote></li> <li><p>循环解析配置类 ： 判断@Conditional等，接下来解析各种配置类的操作，这里有些操作还没有真正执行。</p></li> <li><p>有@Component 看里面有不内部类，没有就跳过，有就递归解析内部类</p></li> <li><p>有@PropertySources，处理配置文件，添加到Environment中。</p></li> <li><p>有@ComponentScans, 执行scanner.doScan()，并且把扫描的BeanDefiniton递归解析配置类</p></li> <li><p>有@Import，递归获得Import里面的Import的配置类。</p> <blockquote><ol><li>如果是ImportSelector，那么调用执行selectImports方法得到类名，然后在把这个类当做配置类进行解析**（也是递归）**</li> <li>如果实现的事DeferredImportSelector，则是推迟到这一批执行完后再执行。</li> <li>如果是ImportBeanDefinitionRegistrar，那么则生成一个ImportBeanDefinitionRegistrar实例对象，并添加到配置类对象中（ConfigurationClass）的<strong>importBeanDefinitionRegistrars</strong>属性中。</li> <li>就是普通的类，则把他当做配置类解析。</li></ol></blockquote></li> <li><p>有@ImportResource，引入spring配置文件.xml，实现xml配置的bean装载</p></li> <li><p>有@Bean的方法和接口里面的@Bean : 往BeanDefinition中addBeanMethod</p></li> <li><p>再递归父类的内容</p></li> <li><p>再加载上面已经解析的配置类，reader.loadBeanDefinitions ： @Bean、@Import、@ImportResource、ImportBeanDefinitionRegistrar 接口，他们真正注册BeanDefinition。</p></li> <li><p>他们过程产生新的BeanDefinition，接着循环解析。</p></li></ul></li> <li><p>postProcessBeanFactory 中 ：  做的事情</p> <ul><li><p>没有执行过processConfigBeanDefinitions ，就执行。 一般都是执行过了的。</p></li> <li><p>遍历所有BeanDefenition找到full类型的配置类，为他生成代理类，修改对应的BeanDefenition的BeanClass，代理逻辑为根据@Bean或者方法名  执行，beanFactory.getBean(beanName, beanMethodArgs)； 方法。</p></li> <li><p>最后 beanFactory.addBeanPostProcessor( new ImportAwareBeanPostProcessor(beanFactory) ); // 用于注册ImportAware  (可以类上的AnnotationMetadata信息);</p></li></ul></li></ol> <h1 id="beanpostprocessor"><a href="#beanpostprocessor" class="header-anchor">#</a> BeanPostProcessor</h1> <p>0 = {ApplicationContextAwareProcessor@1231}
1 = {ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor@1687}
2 = {PostProcessorRegistrationDelegate$BeanPostProcessorChecker@1725}
3 = {CommonAnnotationBeanPostProcessor@1746}
4 = {AutowiredAnnotationBeanPostProcessor@1717}
5 = {ApplicationListenerDetector@1798}</p> <p>ApplicationContextAwareProcessor 执行扩展的Aware操作.
ImportAwareBeanPostProcessor     执行扩展的Aware操作.
BeanPostProcessorChecker   校验</p> <p>CommonAnnotationBeanPostProcessor
postProcessMergedBeanDefinition =&gt; 1. 寻找@Resource注入点并缓存. 2.@PostConstruct @PreDestroy 注解的init 和 destory方法。
postProcessProperties     =》 填充属性</p> <p>AutowiredAnnotationBeanPostProcessor</p> <div class="language- extra-class"><pre><code>postProcessMergedBeanDefinition  =&gt; 寻找@Autowired,@Value,@Inject注入点并缓存.
postProcessProperties     =》 填充属性
determineCandidateConstructors =》 推断构造方法, 解析@LookUp
</code></pre></div><p>ApplicationListenerDetector
postProcessAfterInitialization =&gt; 添加监听器.</p> <h1 id="springioc-启动过程"><a href="#springioc-启动过程" class="header-anchor">#</a> springIOC 启动过程:</h1> <ol><li><p>AnnotatedBeanDefinitionReader</p> <ul><li><p>new StandardEnvironment()</p></li> <li><p>new ConditionEvaluator()  // 用来解析@Conditional</p></li> <li><p>registerAnnotationConfigProcessors</p> <blockquote><ol><li><p>用于排序的 beanFactory.setDependencyComparator(new AnnotationAwareOrderComparator())</p></li> <li><p>用于设置懒加载,@Value 判断@Qualifier    beanFactory.setAutowireCandidateResolver(new ContextAnnotationAutowireCandidateResolver());</p></li> <li><p>注册默认的BeanDefinition: ConfigurationClassPostProcessor,AutowiredAnnotationBeanPostProcessor,CommonAnnotationBeanPostProcessor,PersistenceAnnotationBeanPostProcessor(jpa才会注册),EventListenerMethodProcessor,DefaultEventListenerFactory</p></li></ol></blockquote></li></ul></li> <li><p>ClassPathBeanDefinitionScanner</p> <ul><li>设置 registry ，environment，resourceLoader</li> <li>添加默认的includeFilters： @Component 的 @javax.annotation.ManagedBean @javax.inject.Named</li></ul></li> <li><p>注册手工设置的BeanDefinition</p></li> <li><p>调用refresh()，如下</p></li> <li><p>prepareRefresh :</p></li></ol> <ul><li>initPropertySources(); 设置初始化环境变量.</li> <li>validateRequiredProperties(); 校验必须的环境变量.</li> <li>初始化earlyApplicationEvents （用于发布早期事件.）</li></ul> <ol start="6"><li><p>obtainFreshBeanFactory:  获得新的BeanFactiory逻辑，里面会校验是否可以刷新，如果可以刷新的会销毁之前BeanFactory的beans</p></li> <li><p>prepareBeanFactory(beanFactory) :</p> <ul><li>设置BeanFactory的类加载器、SpringEL表达式解析器 StandardBeanExpressionResolver、类型转化注册器ResourceEditorRegistrar</li> <li>addBeanPostProcessor实例 ： ApplicationContextAwareProcessor（初始化先的各种Aware接口注入），ApplicationListenerDetector，LoadTimeWeaverAwareProcessor（如果支持Aspectj的代理）</li> <li>设置ignoreDependencyInterface（是Spring中的自动注入，不是@Autowired）：EnvironmentAware，EmbeddedValueResolverAware，ResourceLoaderAware，ApplicationEventPublisherAware，MessageSourceAware，ApplicationContextAware，ApplicationStartupAware</li> <li>registerResolvableDependency ： BeanFactory，ResourceLoader，ApplicationEventPublisher，ApplicationContext</li> <li>registerSingleton： environment，systemProperties，systemEnvironment，applicationStartup（DefaultApplicationStartup）</li></ul></li> <li><p>postProcessBeanFactory:  子类来设置一下BeanFactory</p></li> <li><p>invokeBeanFactoryPostProcessors</p> <ul><li>执行通过ApplicationContext添加进来的BeanDefinitionRegistryPostProcessor的postProcessBeanDefinitionRegistry()方法</li> <li>执行BeanFactory中实现了PriorityOrdered接口的BeanDefinitionRegistryPostProcessor的postProcessBeanDefinitionRegistry()方法</li> <li>执行BeanFactory中实现了Ordered接口的BeanDefinitionRegistryPostProcessor的postProcessBeanDefinitionRegistry()方法</li> <li>执行BeanFactory中其他的BeanDefinitionRegistryPostProcessor的postProcessBeanDefinitionRegistry()方法</li> <li>执行上面所有的BeanDefinitionRegistryPostProcessor的postProcessBeanFactory()方法</li> <li>执行通过ApplicationContext添加进来的BeanFactoryPostProcessor的postProcessBeanFactory()方法</li> <li>执行BeanFactory中实现了PriorityOrdered接口的BeanFactoryPostProcessor的postProcessBeanFactory()方法</li> <li>执行BeanFactory中实现了Ordered接口的BeanFactoryPostProcessor的postProcessBeanFactory()方法</li> <li>执行BeanFactory中其他的BeanFactoryPostProcessor的postProcessBeanFactory()方法</li></ul></li> <li><p>registerBeanPostProcessors</p> <blockquote><p>因为上面的步骤完成了扫描，这个过程中程序员可能自己定义了一些BeanPostProcessor，在这一步就会把BeanFactory中所有的BeanPostProcessor的BeanDefinition找出来并实例化得到一个对象(getBean)，并添加到BeanFactory中去（属性<strong>beanPostProcessors</strong>），最后再重新new和添加一个ApplicationListenerDetector对象（之前其实就new和添加了过，这里是为了把ApplicationListenerDetector移动到最后）</p> <p>上面的具体步骤:</p> <p>获得所有的BeanPostProcessor的name -》 找出PriorityOrdered，getBean且排序后再add  -》 先找出Ordered，getBean且排序后再add  -》 再找出普通的BeanPostProcessor，getBean再add（没有排序）  -》 先找出MergedBeanDefinitionPostProcessor（代表spring内部的），排序后再add  -》  最后再重新添加一个new ApplicationListenerDetector对象。</p> <p>细节:</p> <p>再addBeanPostProcessor操作的时候，他会先remove，add.
ApplicationListenerDetector他的equals对象是判断它里面的application是否相同的。</p></blockquote></li> <li><p>initMessageSource ： 初始化国际化，设置messageSource单例，要么是用户设置的，要么是DelegatingMessageSource</p></li> <li><p>initApplicationEventMulticaster：事件广播者，设置applicationEventMulticaster单例，用户设置或SimpleApplicationEventMulticaster</p></li> <li><p>onRefresh():  给子类的模板方法，执行刷新。</p></li> <li><p>registerListeners ： 添加了事件监听器，并且广播earlyApplicationEvents的事件，并且把earlyApplicationEvents置null</p></li> <li><p>finishBeanFactoryInitialization</p> <ul><li>如果单例池中有conversionService的类,就设置beanFactory.setConversionService，用于代替上面的setAutowireCandidateResolver</li> <li>如果没有StringValueResolver，则设置默认的基于环境变量的占位符解析器。 ${xxx} =&gt; a</li> <li>先所有初始化单例的LoadTimeWeaverAware</li> <li>冻结BeanDefinitionNames的内容，也就是说BeanDefinitions已经不再添加和删除了。里面的内容可以更改。</li> <li>实例化非懒加载的单例Bean</li></ul></li> <li><p>finishRefresh</p> <ul><li>clearResourceCaches ;  清除已经没有用的ASM metadata</li> <li>initLifecycleProcessor:   设置lifecycleProcessor单例，默认为DefaultLifecycleProcessor</li> <li>getLifecycleProcessor().onRefresh();   调用所有的Lifecycle的Bean的start()</li> <li>publishEvent(event) ;  广播完成事件.</li></ul></li> <li><p>resetCommonCaches ： 反射、classLoader、type 等等缓存清理。</p></li></ol> <h1 id="aop"><a href="#aop" class="header-anchor">#</a> AOP</h1> <p>spring中的aop都继承AbstractAutoProxyCreator implements SmartInstantiationAwareBeanPostProcessor, BeanFactoryAware</p> <p>实现了getEarlyBeanReference、postProcessBeforeInstantiation、postProcessAfterInitialization.扩展点。</p> <p>利用模板模式，实现了。1. 他把循环依赖和初始化后，利用保证同一代理对象。 2. 他定义了允许初始化前自定义的代理对象逻辑。</p> <p>并且定义了getAdvicesAndAdvisorsForBean方法获得所有的Interceptors，供子类实现。</p> <p>主要方法wrapIfNecessary :</p> <p>从缓存中有的，已经判断过了的、正在创建的Bean的，和子类getAdvicesAndAdvisorsForBean方法为null的，都直接返回bean。</p> <p>把bean包装成TargetSource，同时把返回的Interceptors适配成Advisor，在创建ProxyFactory并且getProxy();</p> <h2 id="enableaspectjautoproxy"><a href="#enableaspectjautoproxy" class="header-anchor">#</a> @EnableAspectJAutoProxy</h2> <p>注册一个AnnotationAwareAspectJAutoProxyCreator的BeanDefinition，并且设置对应的属性。</p> <p>他继承了AnnotationAwareAspectJAutoProxyCreator   -&gt;&gt; AspectJAwareAdvisorAutoProxyCreator -&gt;&gt; AbstractAdvisorAutoProxyCreator -&gt;&gt; AbstractAutoProxyCreator</p> <p>所以这里主要看他们实现的getAdvicesAndAdvisorsForBean方法中调用的findCandidateAdvisors:</p> <ol><li>他调用super.findAdvisorBeans(); 获得所有实现Advisor接口的bean.</li> <li>再从所有切面中解析得到所有Advisor对象。
<ul><li>遍历所有的bean，判断类上有@Aspect 并且 名字开头不能为 ajc$</li> <li>利用BeanFactoryAspectInstanceFactory来解析Aspect类</li> <li>遍历一个类上没有@Pointcut的方法，再判断是否有@Pointcut, @Around@Before@ After@AfterReturning@AfterThrowing注解；并且生成AspectJExpressionPointcut；</li> <li>aspectJAdvisorFactory.getAdvice 构建Advice，生成对应的@Around@Before@After</li> <li>把上面的构建为Advisor，对应类为InstantiationModelAwarePointcutAdvisorImpl  implements  PointcutAdvisor。</li></ul></li> <li>筛选满足条件的Advisor集合</li> <li>再进行排序.</li> <li>适配，createProxy，</li></ol> <h2 id="equals-hashcode-getclass方法会代理吗"><a href="#equals-hashcode-getclass方法会代理吗" class="header-anchor">#</a> <a href="https://blog.csdn.net/qq_36874177/article/details/78504849" target="_blank" rel="noopener noreferrer">equals，hashCode，getClass方法会代理吗?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <blockquote><p>如果是jdk的代理的话他只能代理接口的内容，Object的final方法是不会代理的（notify、notifyAll、wait、getClass），接口不能定义这些方法，会报错的。</p> <p>cglib是基于继承的，所以Object的final方法也不会代理。</p> <p>但是再Proxy代码里面会判断equals，hashCode方法。</p></blockquote> <h2 id="proxyfactory的运用"><a href="#proxyfactory的运用" class="header-anchor">#</a> ProxyFactory的运用</h2> <p>getProxy 运行过程:</p> <ol><li>构建 adviseds ，创建确定是jdk还是cglib的AopProxy代理</li> <li>getProxy 执行 :  不管是jdk还是cglib都是对应的流程。</li> <li>设置classLoad，设置接口或者父类，生成callback中的invoke内容。</li> <li>在invoke或者callFiltert中判断，equals、hashCode不会被代理。</li> <li>再执行TargetSource.getTarget() 获得原始对象。</li> <li>通过DefaultAdvisorChainFactory，处理PointcutAdvisor、IntroductionAdvisor、Advisor 将他们适配成MethodInterceptor集合链路，并且缓存起来。</li> <li>把上面获得的内容，构造MethodInvocation对象，执行proceed()方法。</li> <li>proceed内部执行，链路形式执行MethodInterceptor.invoke(MethodInvocation);方法。</li> <li>在我们编写的MethodInterceptor中执行MethodInvocation.proceed方法，将会链路递归执行，到最后一个。</li> <li>MethodInvocation和MethodInterceptor互相调用就是责任链的经典实现。</li></ol> <h2 id="targetsource的使用"><a href="#targetsource的使用" class="header-anchor">#</a> TargetSource的使用</h2> <p>@Lazy 就是用的ProxyFactory中生成代理对象，再TargetSource的getTarget中才去spring.getBean。</p> <h2 id="常见问题"><a href="#常见问题" class="header-anchor">#</a> 常见问题:</h2> <ol><li><p>代码中事务失效的情况：</p> <blockquote><p>类没有被Spring管理、方法不是 public的 -- 该异常一般情况都会被编译器识别、方法是final的、自身this调用、异常被捕获、抛出异常类型不对、传播类型不支持事务、数据库本身不支持事务。</p></blockquote></li> <li><p>为啥自身this调用事务方法，传播机制失效。</p> <blockquote><p>spring基于cglib的代理实现，cglib的代理是基于父子类，内部把被代理对象放到target属性中，执行业务方法时，其实是taget.xxx();  再方法中 this.***(); 其实还是target再执行，而不是代理对象在执行。所以失效。 解决办法是注入自己类，这里会触发循环依赖机制。</p></blockquote></li></ol> <h1 id="事务"><a href="#事务" class="header-anchor">#</a> 事务</h1> <p>@EnableTransactionManagement ， 注册AutoProxyRegistrar，ProxyTransactionManagementConfiguration。</p> <p>AutoProxyRegistrar ： 注册&quot;org.springframework.aop.config.internalAutoProxyCreator&quot;的bean，也就是上面AOP中AbstractAutoProxyCreator的子类，相当于开启了AOP.</p> <p>AbstractTransactionManagementConfiguration : 注册几个bean： TransactionalEventListenerFactory、TransactionInterceptor、AnnotationTransactionAttributeSource、BeanFactoryTransactionAttributeSourceAdvisor。</p> <p>BeanFactoryTransactionAttributeSourceAdvisor &gt; 依赖TransactionAttributeSource.getTransactionAttribute（用来解析@Transactional注解）生成pointcut ，同时依赖 TransactionInterceptor 生成MethodInterceptor</p> <p>TransactionalEventListenerFactory  :  和TransactionSynchronizationManager 事务回调注册接口类似。 实现Spring事务同步和监听。</p> <h2 id="核心类"><a href="#核心类" class="header-anchor">#</a> 核心类</h2> <p>AnnotationTransactionAttributeSource ： 方法映射关系： pointcut.matches(class)   -&gt; isCandidateClass(class);  pointcut.matches(method,class)   -&gt; getTransactionAttribute(method, targetClass) ，该方法还将初始化TransactionAttribute的内容 。</p> <p>他里面运用了组合模式，委托给Set<TransactionAnnotationParser> 去处理。  SpringTransactionAnnotationParser（必有），javax.transaction.Transactional，javax.ejb.TransactionAttribute。 他们3个分别去查找。
重点看： SpringTransactionAnnotationParser的处理，就能找到@Transactional注解的判断和处理了。</TransactionAnnotationParser></p> <p>TransactionAttribute 对应的实现是 RuleBasedTransactionAttribute</p> <hr> <p>TransactionAspectSupport.invokeWithinTransaction : 方法核心。</p> <p><s>下面还是看流程图吧。</s></p> <ol start="0"><li><p>获得TransactionAttribute和获得对应的TransactionManager</p></li> <li><p>createTransactionIfNecessary(ptm, txAttr, joinpointIdentification)  创建必要的事务</p> <ul><li>tm.getTransaction(txAttr) 获得status，他里面会创建事务，并且处理事务的传播机制.</li></ul></li> <li><p>invocation.proceedWithInvocation()  执行业务方法</p></li> <li><p>completeTransactionAfterThrowing(txInfo, ex) 回滚事务并且关闭连接</p></li> <li><p>commitTransactionAfterReturning(txInfo) 提交事务并且关闭连接</p></li></ol> <hr> <p>TransactionAttribute</p> <blockquote><p>事务属性: 就是@Transactional中的一些配置。</p></blockquote> <p>TransactionSynchronizationManager</p> <blockquote><p>事务相关的ThreadLocal统一管理的一些api，比如resources（map&lt;obj,obj&gt; 一般为key为DataSource对象，value为ConnectionHolder对象）、synchronizations、currentTransactionName、currentTransactionReadOnly、currentTransactionIsolationLevel、actualTransactionActive</p> <p>第三方整合事务也经常用到这个，但是不是直接用它，而是用spring提供的DataSourceUtils.getConnection();
可以见mybatis-spring的事务整合。</p></blockquote> <p>TransactionAspectSupport</p> <blockquote><p>他管理 ThreaLocal<TransactionInfo> ，并且控制代理对象的主流程。</TransactionInfo></p> <p>TransactionInfo : TransactionInfo 主要是持有事务的状态，以及上一个TransactionInfo 的一个引用，并与当前线程进行绑定。内部拥有<strong>TransactionStatus</strong></p> <p>TransactionStatus： 主要描述当前事务的状态，比如：是否有事务，是否是新事物，事务是否只读；回滚点相关操作等等。这些相关的属性在后面会影响事务的提交。</p></blockquote> <p>AbstractPlatformTransactionManager</p> <blockquote><p>为TransactionManager接口的实现，主要用于控制开启事务，提交事务，回滚事务，执行扩展点的主流程。</p></blockquote> <h2 id="事务的高级用法"><a href="#事务的高级用法" class="header-anchor">#</a> 事务的高级用法:</h2> <ol><li>事务传播机制 ： @Transactional(propagation = Propagation.REQUIRES_NEW)</li> <li>强制回滚 ：TransactionAspectSupport.currentTransactionStatus().setRollbackOnly()</li> <li><a href="https://blog.csdn.net/f641385712/article/details/91897175" target="_blank" rel="noopener noreferrer">事务同步<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>： TransactionSynchronizationManager.registerSynchronization、@TransactionEventListener</li></ol> <h1 id="自己的疑惑"><a href="#自己的疑惑" class="header-anchor">#</a> 自己的疑惑</h1> <ol><li><p>@EnableAspectJAutoProxy @EnableTransactionManagement 都是导入org.springframework.aop.config.internalAutoProxyCreator的Bean对象，最终是谁呢??</p> <p>最终是EnableAspectJAutoProxy 的是直接selectImports的，他会直接导入AutoProxyRegistrar并且递归解析。它实现了registerBeanDefinitions放到list的前面，所以他的AopConfigUtils.registerAutoProxyCreatorIfNecessary也是先执行。</p> <p>再解析EnableAspectJAutoProxy，时候他已经放到后面了，这时候就是以他的AopConfigUtils.registerAutoProxyCreatorIfNecessary修改BeanDefinition的BeanClass了。</p></li> <li><p><a href="https://blog.csdn.net/qq_39002724/article/details/113609903" target="_blank" rel="noopener noreferrer">spring中autowired注入自己的代理后，最后容器中的对象是原对象还是代理对象。<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>  还是代理对象，执行的时候是cglib的tagert委托对象，所以会有aop失效的情况。</p></li> <li><p>LifecycleProcessor 的用法和应用场景   &gt;  再spring容器启动后执行一些代码。</p></li></ol> <h1 id="注解原理"><a href="#注解原理" class="header-anchor">#</a> 注解原理</h1> <ol><li>@Lazy 注解原理  在哪生成代理.</li></ol> <blockquote><ol><li>再属性填充(依赖注入中) 他是生成的代理对象的标识，具体的再BeanPostProcessor.postProcessProperties 里面生成对应的对应的InjectedElement的子类.</li> <li>再BeanDefinition中，他是判断是否初始化BeanFaction中生成对应的bean</li></ol></blockquote> <ol start="2"><li><p>@Replace  注解  在哪生成代理.</p></li> <li><p>@Configuration 注解在哪生成代理对象.</p> <blockquote><p>再invokeBeanFactoryPostProcessors里面会判断是不是fult类，去生成动态代理。</p></blockquote></li> <li><p><a href="https://my.oschina.net/zudajun/blog/664659" target="_blank" rel="noopener noreferrer">@LookUp 解决什么问题 (.) ，他是在哪实现的??<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ol> <blockquote><p>解决单例依赖多例的情况:</p> <p>determineCandidateConstructors =&gt; 往beanDefinition 添加 LookupOverride方法.
再执行推断构造方法里面生成对应的cglib的代理对象。</p></blockquote> <ol start="5"><li><a href="https://blog.csdn.net/it_lihongmin/article/details/102940643" target="_blank" rel="noopener noreferrer">@EventListener实现方式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <blockquote><p>EventListenerMethodProcessor 里面 postProcessBeanFactory里面获得所有的EventListenerFactory，之后再到afterSingletonsInstantiated加载所有单例完后，再遍历所有的bean，判断类上的方法是否有@EventListener，再遍历所有的EventListenerFactory调用supportsMethod(method)过滤，通过后EventListenerFactory.createApplicationListener生成代理对象。</p></blockquote> <h1 id="spring-设计模式"><a href="#spring-设计模式" class="header-anchor">#</a> Spring 设计模式</h1> <table><thead><tr><th>简单工厂</th> <th>BeanFactory体现</th></tr></thead> <tbody><tr><td>工厂方法</td> <td>FactoryBean接口</td></tr> <tr><td>单例模式</td> <td>Spring依赖注入Bean实例默认是单例的，getSingleton()方法</td></tr> <tr><td>装饰器模式</td> <td>一种是类名中含有Wrapper，另一种是类名中含有Decorator</td></tr> <tr><td>代理模式</td> <td>AOP底层，@Configuration</td></tr> <tr><td>观察者模式</td> <td>spring的事件驱动模型，listener的实现</td></tr> <tr><td>策略设计模式</td> <td>资源访问Resource接口，不同的applicationContext的实现等等一些接口多实现类</td></tr> <tr><td>模版方法模式</td> <td>Spring几乎所有的外接扩展都采用这种模式 ，抽象类，JdbcTempalte</td></tr> <tr><td>责任链模式</td> <td>CglibAopProxy#chain，Interceptor#invoke</td></tr></tbody></table> <h2 id="资源访问resource接口"><a href="#资源访问resource接口" class="header-anchor">#</a> 资源访问Resource接口</h2> <ul><li><ul><li>UrlResource：访问网络资源的实现类</li> <li>ClassPathResource：访问类加载路径里资源的实现类</li> <li>FileSystemResource：访问文件系统里资源的实现类</li> <li>ServletContextResource：访问相对于 ServletContext 路径里的资源的实现类</li> <li>InputStreamResource：访问输入流资源的实现类</li> <li>ByteArrayResource：访问字节数组资源的实现类</li></ul></li></ul> <h1 id="spring核心api"><a href="#spring核心api" class="header-anchor">#</a> Spring核心API</h1> <h2 id="beanfactory"><a href="#beanfactory" class="header-anchor">#</a> BeanFactory</h2> <ul><li>getBean</li> <li>containsBean</li> <li>isSingleton/Prototype</li> <li>isMatch</li></ul> <h2 id="beandefinition"><a href="#beandefinition" class="header-anchor">#</a> BeanDefinition</h2> <p>用来描述Bean,里面存放Bean元数据，比如Bean类名、scope、属性、构造函数参数列表、依赖的bean、是否是单例类、是否是懒加载等一些列信息。</p> <h3 id="实现类"><a href="#实现类" class="header-anchor">#</a> 实现类</h3> <ul><li><p>ChildBeanDefinition</p></li> <li><p>RootBeanDefinition ， 代表一个xml,java Config来的BeanDefinition</p></li> <li><p>GenericBeanDefinition</p></li> <li><p>MergedBeanDefinition</p></li> <li><p>AnnotatedBeanDefinition</p> <blockquote><ul><li>表示注解类型bean定义</li> <li>AnnotationMetadata，注解元信息</li> <li>MethodMetadata，方法元信息</li></ul></blockquote></li></ul> <h2 id="beandefinitionregistry"><a href="#beandefinitionregistry" class="header-anchor">#</a> BeanDefinitionRegistry</h2> <ul><li>有增，查，删BeanDefinition的能力。一次只能注册一个BeanDefinition.</li></ul> <h3 id="实现类-2"><a href="#实现类-2" class="header-anchor">#</a> 实现类</h3> <ul><li>SimpleBeanDefinitionRegistry</li> <li>DefaultListableBeanFactory</li> <li>GenericApplicationContext</li></ul> <h1 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h1> <ul><li>描述下BeanFactory。</li> <li>BeanFactory和ApplicationContext的区别？</li> <li>简述SpringIoC的加载过程。</li> <li>Spring中有哪些扩展接口及调用时机。</li> <li>怎么解决循环依赖</li></ul> <h1 id="扩展点"><a href="#扩展点" class="header-anchor">#</a> 扩展点</h1> <h2 id="beanfactorypostprocessor-2"><a href="#beanfactorypostprocessor-2" class="header-anchor">#</a> BeanFactoryPostProcessor</h2> <h3 id="beandefinitionregistrypostprocessor"><a href="#beandefinitionregistrypostprocessor" class="header-anchor">#</a> BeanDefinitionRegistryPostProcessor</h3> <h2 id="beanpostprocessor-2"><a href="#beanpostprocessor-2" class="header-anchor">#</a> BeanPostProcessor</h2> <h3 id="instantiationawarebeanpostprocessor"><a href="#instantiationawarebeanpostprocessor" class="header-anchor">#</a> InstantiationAwareBeanPostProcessor</h3> <h3 id="abstractautoproxycreator"><a href="#abstractautoproxycreator" class="header-anchor">#</a> AbstractAutoProxyCreator</h3> <h2 id="import"><a href="#import" class="header-anchor">#</a> @Import</h2> <h3 id="importbeandefinitionregistrar"><a href="#importbeandefinitionregistrar" class="header-anchor">#</a> ImportBeanDefinitionRegistrar</h3> <ul><li>FeignClientsRegistrar</li></ul> <h2 id="aware"><a href="#aware" class="header-anchor">#</a> Aware</h2> <h2 id="initializingbean"><a href="#initializingbean" class="header-anchor">#</a> InitializingBean</h2> <h2 id="factorybean"><a href="#factorybean" class="header-anchor">#</a> FactoryBean</h2> <ul><li>FeignClientFactorybean</li> <li>MapperFactoryBean</li> <li>NacosDataSourceFactoryBean</li></ul> <h2 id="smartinitializingsingleton"><a href="#smartinitializingsingleton" class="header-anchor">#</a> SmartInitializingSingleton</h2> <ul><li>LoadBalancerAutoConfiguration</li></ul> <h2 id="applicationlistener"><a href="#applicationlistener" class="header-anchor">#</a> ApplicationListener</h2> <ul><li>NacosAutoServiceRegistration#onApplicationEvent</li></ul> <h2 id="lifecycle"><a href="#lifecycle" class="header-anchor">#</a> Lifecycle</h2> <h3 id="smartlifecycle"><a href="#smartlifecycle" class="header-anchor">#</a> <a href="https://www.jianshu.com/p/7b8f2a97c8f5" target="_blank" rel="noopener noreferrer">SmartLifecycle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <p>在Spring加载和初始化所有bean后，接着执行一些任务或者启动需要的异步服务，这样我们可以使用 SmartLifecycle 来做到</p> <ul><li>NacosWatch#start</li> <li>EurekaServerInitializerConfiguration</li></ul> <h3 id="lifecycleprocessor"><a href="#lifecycleprocessor" class="header-anchor">#</a> LifecycleProcessor</h3> <h2 id="handlerinterceptor"><a href="#handlerinterceptor" class="header-anchor">#</a> HandlerInterceptor</h2> <ul><li>SentinelDataSourceHandler</li></ul> <h2 id="methodinterceptor"><a href="#methodinterceptor" class="header-anchor">#</a> MethodInterceptor</h2> <ul><li>seata中的GlobalTransactionalInterceptor</li> <li>AOP</li> <li>TransactionInterceptor</li></ul> <h1 id="参考资料-2"><a href="#参考资料-2" class="header-anchor">#</a> 参考资料</h1> <p><a href="https://www.cnblogs.com/gcdd1993/p/12292214.html" target="_blank" rel="noopener noreferrer">Spring事件驱动模型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/wulinghui/TechnicalSummary/edit/master/docs/java/30.spring/01.spring源码分析.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/01/24, 15:21:15</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/a2a4f1/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">spring官网项目介绍</div></a> <a href="/pages/915c4e/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">spring-mvc</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/a2a4f1/" class="prev">spring官网项目介绍</a></span> <span class="next"><a href="/pages/915c4e/">spring-mvc</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/fff88c/"><div>
            架构升级踩坑之路
            <!----></div></a> <span class="date">02-27</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/ba6503/"><div>
            总结
            <!----></div></a> <span class="date">02-27</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/1b4e40/"><div>
            语法学习
            <!----></div></a> <span class="date">02-27</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:873406903@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/wulinghui" title="GitHub(移步到gitee)" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/hellowllh/projects" title="gitee" target="_blank" class="iconfont icon-gitee"></a><a href="https://blog.csdn.net/qq_41720208" title="CSDN" target="_blank" class="iconfont icon-gitee"></a><a href="https://www.cnblogs.com/wlh1995" title="博客园" target="_blank" class="iconfont icon-bokeyuan"></a></div> 
    | Copyright © 2021-2025
    <span>Wu lingui | <a href="" target="_blank"></a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.7f63dd6c.js" defer></script><script src="/assets/js/2.fe5f2a1d.js" defer></script><script src="/assets/js/3.eb8c603e.js" defer></script><script src="/assets/js/152.bc7ad385.js" defer></script>
  </body>
</html>
